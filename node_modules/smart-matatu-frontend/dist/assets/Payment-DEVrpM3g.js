import{u as w,b as P,j as e,a as h}from"./index-DJcsNwFI.js";import{r as l}from"./vendor-BKU87Gzz.js";import{b as S,c as L}from"./router-BF-yxxER.js";import"./icons-l6XdvyrE.js";const T=()=>{const{t:s}=w(),{state:f}=P(),o=S(),[i]=L(),[a,g]=l.useState(null),[j,b]=l.useState(!0),[p,c]=l.useState(!1),[m,n]=l.useState(null),[x,u]=l.useState("stripe");l.useEffect(()=>{const t=i.get("plan"),r=i.get("amount"),d=i.get("planName");if(!t||!r){n(s("payment.errors.invalidData")),b(!1);return}const v={free:[s("subscription.plans.free.features.basicInfo"),s("subscription.plans.free.features.reports"),s("subscription.plans.free.features.support")],premium:[s("subscription.plans.premium.features.unlimitedReports"),s("subscription.plans.premium.features.advancedAnalytics"),s("subscription.plans.premium.features.prioritySupport"),s("subscription.plans.premium.features.realTimeNotifications")],sacco:[s("subscription.plans.sacco.features.allPremium"),s("subscription.plans.sacco.features.revenueAnalytics"),s("subscription.plans.sacco.features.customBranding"),s("subscription.plans.sacco.features.apiAccess"),s("subscription.plans.sacco.features.dedicatedSupport")],enterprise:[s("subscription.plans.enterprise.features.allSacco"),s("subscription.plans.enterprise.features.whiteLabel"),s("subscription.plans.enterprise.features.customIntegrations"),s("subscription.plans.enterprise.features.support247"),s("subscription.plans.enterprise.features.slaGuarantee")]};g({amount:parseInt(r),currency:"KES",description:`${d||t} ${s("payment.subscriptionWord")}`,planType:t,planName:d||t,features:v[t]||[]}),b(!1)},[i,s]);const N=async()=>{if(!(!a||!f.user)){c(!0),n(null);try{if(f.user.email==="nelsonmaranda2@gmail.com"){(await h.confirmPayment("admin_payment",a.planType)).success&&o("/subscription?success=true&plan="+a.planType);return}const t=await h.createPaymentIntent(a.amount,a.currency,a.description);t.success&&t.data?setTimeout(async()=>{var r;try{(await h.confirmPayment(((r=t.data)==null?void 0:r.paymentId)||"",a.planType)).success?o("/subscription?success=true&plan="+a.planType):n(s("payment.errors.confirmFailed"))}catch{n(s("payment.errors.confirmFailed"))}finally{c(!1)}},2e3):(n(s("payment.errors.createFailed")),c(!1))}catch{n(s("payment.errors.paymentFailed")),c(!1)}}},y=()=>{o("/subscription")};return j?e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),e.jsx("p",{className:"mt-4 text-gray-600",children:s("common.loading")})]})}):m&&!a?e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsx("div",{className:"text-center",children:e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-md p-6 max-w-md",children:e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("svg",{className:"h-5 w-5 text-red-400",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})}),e.jsxs("div",{className:"ml-3",children:[e.jsx("h3",{className:"text-sm font-medium text-red-800",children:s("payment.errors.header")}),e.jsx("p",{className:"mt-1 text-sm text-red-700",children:m}),e.jsx("button",{onClick:y,className:"mt-3 bg-red-100 text-red-800 px-3 py-1 rounded-md text-sm hover:bg-red-200",children:s("payment.backToPlans")})]})]})})})}):e.jsx("div",{className:"min-h-screen bg-gray-50 py-8",children:e.jsxs("div",{className:"max-w-2xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:s("payment.title")}),e.jsx("p",{className:"text-gray-600",children:s("payment.subtitle").replace("{plan}",(a==null?void 0:a.planName)||"")})]}),e.jsxs("div",{className:"bg-white shadow rounded-lg mb-8",children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:e.jsx("h2",{className:"text-lg font-medium text-gray-900",children:s("payment.orderSummary")})}),e.jsxs("div",{className:"px-6 py-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:s("payment.planLabel").replace("{plan}",(a==null?void 0:a.planName)||"")}),e.jsx("p",{className:"text-sm text-gray-500",children:s("payment.monthly")})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:(a==null?void 0:a.amount)===0?s("payment.free"):`KES ${a==null?void 0:a.amount.toLocaleString()}`}),a&&a.amount>0&&e.jsx("p",{className:"text-sm text-gray-500",children:s("payment.perMonth")})]})]}),e.jsxs("div",{className:"border-t border-gray-200 pt-4",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-900 mb-2",children:s("payment.planFeatures")}),e.jsx("ul",{className:"space-y-1",children:a==null?void 0:a.features.map((t,r)=>e.jsxs("li",{className:"flex items-center text-sm text-gray-600",children:[e.jsx("svg",{className:"h-4 w-4 text-green-500 mr-2",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),t]},r))})]})]})]}),e.jsxs("div",{className:"bg-white shadow rounded-lg mb-8",children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:e.jsx("h2",{className:"text-lg font-medium text-gray-900",children:s("payment.paymentMethod")})}),e.jsx("div",{className:"px-6 py-4",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{id:"stripe",name:"payment-method",type:"radio",value:"stripe",checked:x==="stripe",onChange:t=>u(t.target.value),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300"}),e.jsxs("label",{htmlFor:"stripe",className:"ml-3 flex items-center",children:[e.jsx("svg",{className:"h-6 w-6 mr-2",viewBox:"0 0 24 24",fill:"currentColor",children:e.jsx("path",{d:"M13.976 9.15c-2.172-.806-3.356-1.426-3.356-2.409 0-.831.683-1.305 1.901-1.305 2.227 0 4.515.858 6.09 1.631l.89-5.494C18.252.274 15.697 0 12.165 0 9.667 0 7.589.654 6.104 1.872 4.56 3.147 3.757 4.992 3.757 7.218c0 4.039 2.467 5.76 6.476 7.219 2.585.92 3.445 1.574 3.445 2.583 0 .98-.84 1.573-2.354 1.573-1.875 0-4.965-.921-6.99-2.109l-.9 5.555C5.175 22.99 8.385 24 11.714 24c2.641 0 4.843-.624 6.328-1.813 1.664-1.305 2.525-3.236 2.525-5.732 0-4.128-2.524-5.851-6.591-7.305z"})}),e.jsx("span",{className:"text-sm font-medium text-gray-700",children:s("payment.card")})]})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{id:"mpesa",name:"payment-method",type:"radio",value:"mpesa",checked:x==="mpesa",onChange:t=>u(t.target.value),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300"}),e.jsxs("label",{htmlFor:"mpesa",className:"ml-3 flex items-center",children:[e.jsx("div",{className:"h-6 w-6 mr-2 bg-green-600 rounded flex items-center justify-center",children:e.jsx("span",{className:"text-white text-xs font-bold",children:"M"})}),e.jsx("span",{className:"text-sm font-medium text-gray-700",children:s("payment.mpesa")})]})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{id:"airtel",name:"payment-method",type:"radio",value:"airtel",checked:x==="airtel",onChange:t=>u(t.target.value),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300"}),e.jsxs("label",{htmlFor:"airtel",className:"ml-3 flex items-center",children:[e.jsx("div",{className:"h-6 w-6 mr-2 bg-red-600 rounded flex items-center justify-center",children:e.jsx("span",{className:"text-white text-xs font-bold",children:"A"})}),e.jsx("span",{className:"text-sm font-medium text-gray-700",children:s("payment.airtel")})]})]})]})})]}),m&&e.jsx("div",{className:"mb-6 bg-red-50 border border-red-200 rounded-md p-4",children:e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("svg",{className:"h-5 w-5 text-red-400",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})}),e.jsx("div",{className:"ml-3",children:e.jsx("p",{className:"text-sm text-red-800",children:m})})]})}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[e.jsx("button",{onClick:y,className:"flex-1 bg-gray-300 text-gray-700 py-3 px-4 rounded-md font-medium hover:bg-gray-400 transition-colors",children:s("payment.backToPlans")}),e.jsx("button",{onClick:N,disabled:p||(a==null?void 0:a.amount)===0,className:`flex-1 py-3 px-4 rounded-md font-medium transition-colors ${p||(a==null?void 0:a.amount)===0?"bg-gray-300 text-gray-500 cursor-not-allowed":"bg-blue-600 text-white hover:bg-blue-700"}`,children:p?e.jsxs("div",{className:"flex items-center justify-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),s("payment.processingPayment")]}):(a==null?void 0:a.amount)===0?s("payment.activateFreePlan"):s("payment.payAmount").replace("{amount}",((a==null?void 0:a.amount)||0).toLocaleString())})]}),e.jsx("div",{className:"mt-8 text-center",children:e.jsxs("div",{className:"flex items-center justify-center text-sm text-gray-500",children:[e.jsx("svg",{className:"h-4 w-4 mr-1",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M5 9V7a5 5 0 0110 0v2a2 2 0 012 2v5a2 2 0 01-2 2H5a2 2 0 01-2-2v-5a2 2 0 012-2zm8-2v2H7V7a3 3 0 016 0z",clipRule:"evenodd"})}),s("payment.secureNote")]})})]})})};export{T as default};
//# sourceMappingURL=Payment-DEVrpM3g.js.map
