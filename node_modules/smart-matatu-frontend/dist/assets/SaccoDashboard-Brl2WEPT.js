import{u as z,a as A,j as e}from"./index-B89RGDpK.js";import{r as c}from"./vendor-BKU87Gzz.js";import{R as v,B as E,M as b,c as w,a0 as I,a1 as S,V as K,k as g,T as k}from"./icons-laTIaZ17.js";import"./router-Z6rqMkFf.js";function q(){const{t}=z(),[l,T]=c.useState("overview"),[D,u]=c.useState(!0),[x,m]=c.useState([]),[i,o]=c.useState([]),[R,h]=c.useState([]),[a,p]=c.useState(null),[j,P]=c.useState("30d"),[n,C]=c.useState("all"),y=s=>{const r=typeof s=="number"?s:0;return new Intl.NumberFormat("en-KE",{notation:"compact",compactDisplay:"short",maximumFractionDigits:1}).format(r)};c.useEffect(()=>{N()},[j,n]);const N=async()=>{try{u(!0);const s=await A.getSaccoDashboard();if(s.success&&s.data){const{routePerformance:r,driverPerformance:d,customerFeedback:V,fleetStatus:$}=s.data;m(r||[]),o(d||[]),h(V||[]),p($||null)}else m([]),o([]),h([]),p(null)}catch(s){console.error("Error loading dashboard data:",s),m([]),o([]),h([]),p(null)}finally{u(!1)}},f=s=>{switch(s){case"active":return"text-green-600 bg-green-100";case"warning":return"text-yellow-600 bg-yellow-100";case"suspended":return"text-red-600 bg-red-100";case"resolved":return"text-green-600 bg-green-100";case"in_progress":return"text-blue-600 bg-blue-100";case"pending":return"text-gray-600 bg-gray-100";default:return"text-gray-600 bg-gray-100"}},F=s=>{switch(s){case"up":return e.jsx(k,{className:"w-4 h-4 text-green-500"});case"down":return e.jsx(k,{className:"w-4 h-4 text-red-500 rotate-180"});default:return e.jsx(S,{className:"w-4 h-4 text-gray-500"})}};return D?e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx(v,{className:"w-8 h-8 animate-spin mx-auto mb-4 text-blue-600"}),e.jsx("p",{className:"text-gray-600",children:t("sacco.loading")})]})}):e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx("div",{className:"bg-white shadow-sm border-b",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"flex justify-between items-center py-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:t("sacco.title")}),e.jsx("p",{className:"text-gray-600 mt-1",children:t("sacco.subtitle")})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("select",{value:j,onChange:s=>P(s.target.value),className:"border border-gray-300 rounded-lg px-3 py-2 text-sm",children:[e.jsx("option",{value:"7d",children:t("sacco.date7d")}),e.jsx("option",{value:"30d",children:t("sacco.date30d")}),e.jsx("option",{value:"90d",children:t("sacco.date90d")})]}),e.jsxs("button",{onClick:N,className:"flex items-center space-x-2 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700",children:[e.jsx(v,{className:"w-4 h-4"}),e.jsx("span",{children:t("sacco.refresh")})]})]})]})})}),e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:e.jsx("div",{className:"border-b border-gray-200",children:e.jsx("nav",{className:"-mb-px flex space-x-8",children:[{id:"overview",name:t("sacco.tabs.overview"),icon:E},{id:"routes",name:t("sacco.tabs.routes"),icon:b},{id:"drivers",name:t("sacco.tabs.drivers"),icon:w},{id:"feedback",name:t("sacco.tabs.feedback"),icon:I},{id:"fleet",name:t("sacco.tabs.fleet"),icon:S}].map(s=>e.jsxs("button",{onClick:()=>T(s.id),className:`flex items-center space-x-2 py-4 px-1 border-b-2 font-medium text-sm ${l===s.id?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[e.jsx(s.icon,{className:"w-4 h-4"}),e.jsx("span",{children:s.name})]},s.id))})})}),e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[l==="overview"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsx("div",{className:"bg-white p-6 rounded-lg shadow",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:e.jsx(b,{className:"w-6 h-6 text-blue-600"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:t("sacco.metrics.activeRoutes")}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:x.length})]})]})}),e.jsx("div",{className:"bg-white p-6 rounded-lg shadow",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-2 bg-green-100 rounded-lg",children:e.jsx(w,{className:"w-6 h-6 text-green-600"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:t("sacco.metrics.activeDrivers")}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:i.filter(s=>s.status==="active").length})]})]})}),e.jsx("div",{className:"bg-white p-6 rounded-lg shadow",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-2 bg-yellow-100 rounded-lg",children:e.jsx(K,{className:"w-6 h-6 text-yellow-600"})}),e.jsxs("div",{className:"ml-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:t("sacco.metrics.totalRevenue7d")}),e.jsx("span",{title:t("sacco.revenueTooltip"),className:"inline-flex items-center justify-center w-4 h-4 text-xs bg-gray-100 text-gray-600 rounded-full cursor-help",children:"i"})]}),e.jsxs("p",{className:"text-2xl font-bold text-gray-900",children:["KSh ",y(x.reduce((s,r)=>s+(r.revenue7d||0),0))]})]})]})}),e.jsx("div",{className:"bg-white p-6 rounded-lg shadow",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-2 bg-purple-100 rounded-lg",children:e.jsx(g,{className:"w-6 h-6 text-purple-600"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:t("sacco.metrics.avgRating")}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:i.length>0?(i.reduce((s,r)=>s+(r.customerRating||0),0)/i.length).toFixed(1):"0.0"})]})]})})]}),a&&e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:t("sacco.fleetStatus")}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-3xl font-bold text-blue-600",children:a.activeVehicles}),e.jsx("p",{className:"text-sm text-gray-600",children:t("sacco.activeVehicles")}),e.jsx("p",{className:"text-xs text-gray-500",children:t("sacco.ofTotal").replace("{total}",String(a.totalVehicles))})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-3xl font-bold text-yellow-600",children:a.maintenanceDue}),e.jsx("p",{className:"text-sm text-gray-600",children:t("sacco.maintenanceDue")}),e.jsx("p",{className:"text-xs text-gray-500",children:t("sacco.vehiclesNeedService")})]}),e.jsxs("div",{className:"text-center",children:[e.jsxs("p",{className:"text-3xl font-bold text-green-600",children:[a.utilizationRate,"%"]}),e.jsx("p",{className:"text-sm text-gray-600",children:t("sacco.utilizationRate")}),e.jsx("p",{className:"text-xs text-gray-500",children:t("sacco.averageFleetUsage")})]})]})]})]}),l==="routes"&&e.jsxs("div",{className:"bg-white rounded-lg shadow",children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:t("sacco.routePerformance")})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:t("sacco.table.route")}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:t("sacco.table.efficiency")}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:t("sacco.table.revenue7d")}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:t("sacco.table.passengers")}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:t("sacco.table.onTime")}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:t("sacco.table.safety")}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:t("sacco.table.trend")})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:x.map(s=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:s.routeNumber}),e.jsx("div",{className:"text-sm text-gray-500",children:s.routeName})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-16 bg-gray-200 rounded-full h-2 mr-2",children:e.jsx("div",{className:"bg-blue-600 h-2 rounded-full",style:{width:`${s.efficiencyScore}%`}})}),e.jsxs("span",{className:"text-sm text-gray-900",children:[s.efficiencyScore,"%"]})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("span",{children:["KSh ",y(s.revenue7d||0)]}),e.jsx("span",{title:`Estimated over last 7 days: unique devices × fare (fare: KSh ${s.fare??0})`,className:"inline-flex items-center justify-center w-4 h-4 text-xs bg-gray-100 text-gray-600 rounded-full cursor-help",children:"i"})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:s.passengerCount}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:[s.onTimePercentage,"%"]}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:[s.safetyScore,"%"]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:F(s.trend)})]},s.routeId))})]})})]}),l==="drivers"&&e.jsxs("div",{className:"bg-white rounded-lg shadow",children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:t("sacco.driverPerformance")})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:t("sacco.driversTable.driver")}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:t("sacco.driversTable.safetyScore")}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:t("sacco.driversTable.onTime")}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:t("sacco.driversTable.rating")}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:t("sacco.driversTable.incidents")}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:t("sacco.driversTable.status")}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:t("sacco.driversTable.routes")})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:i.map(s=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"text-sm font-medium text-gray-900",children:s.driverName})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-16 bg-gray-200 rounded-full h-2 mr-2",children:e.jsx("div",{className:"bg-green-600 h-2 rounded-full",style:{width:`${s.safetyScore}%`}})}),e.jsxs("span",{className:"text-sm text-gray-900",children:[s.safetyScore,"%"]})]})}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:[s.onTimePercentage,"%"]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(g,{className:"w-4 h-4 text-yellow-400 fill-current"}),e.jsx("span",{className:"ml-1 text-sm text-gray-900",children:s.customerRating})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:s.incidentCount}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${f(s.status)}`,children:s.status})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:s.routes.join(", ")})]},s.driverId))})]})})]}),l==="feedback"&&e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"bg-white rounded-lg shadow",children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:t("sacco.customerFeedback")}),e.jsxs("select",{value:n,onChange:s=>C(s.target.value),className:"border border-gray-300 rounded-lg px-3 py-2 text-sm",children:[e.jsx("option",{value:"all",children:t("sacco.filters.allStatus")}),e.jsx("option",{value:"pending",children:t("sacco.filters.pending")}),e.jsx("option",{value:"in_progress",children:t("sacco.filters.inProgress")}),e.jsx("option",{value:"resolved",children:t("sacco.filters.resolved")})]})]})}),e.jsx("div",{className:"divide-y divide-gray-200",children:R.filter(s=>n==="all"||s.status===n).map(s=>e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-900",children:s.routeName}),e.jsx("div",{className:"flex items-center",children:[...Array(5)].map((r,d)=>e.jsx(g,{className:`w-4 h-4 ${d<s.rating?"text-yellow-400 fill-current":"text-gray-300"}`},d))})]}),e.jsx("p",{className:"text-sm text-gray-600 mb-2",children:s.comment}),e.jsxs("div",{className:"flex items-center space-x-4 text-xs text-gray-500",children:[e.jsx("span",{className:"capitalize",children:s.category}),e.jsx("span",{children:"•"}),e.jsx("span",{children:new Date(s.createdAt).toLocaleDateString()}),s.responseTime&&e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"•"}),e.jsx("span",{children:t("sacco.resolvedInDays").replace("{days}",String(s.responseTime))})]})]})]}),e.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${f(s.status)}`,children:s.status})]})},s.id))})]})}),l==="fleet"&&a&&e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:t("sacco.fleetOverview")}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-gray-600",children:t("sacco.totalVehicles")}),e.jsx("span",{className:"text-lg font-semibold",children:a.totalVehicles})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-gray-600",children:t("sacco.activeVehicles")}),e.jsx("span",{className:"text-lg font-semibold text-green-600",children:a.activeVehicles})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-gray-600",children:t("sacco.maintenanceDue")}),e.jsx("span",{className:"text-lg font-semibold text-yellow-600",children:a.maintenanceDue})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-gray-600",children:t("sacco.averageAge")}),e.jsxs("span",{className:"text-lg font-semibold",children:[a.averageAge," ",t("sacco.years")]})]})]})]}),e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:t("sacco.utilizationRate")}),e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"relative w-32 h-32 mx-auto mb-4",children:[e.jsxs("svg",{className:"w-32 h-32 transform -rotate-90",viewBox:"0 0 36 36",children:[e.jsx("path",{className:"text-gray-200",stroke:"currentColor",strokeWidth:"3",fill:"none",d:"M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831"}),e.jsx("path",{className:"text-blue-600",stroke:"currentColor",strokeWidth:"3",fill:"none",strokeDasharray:`${a.utilizationRate}, 100`,d:"M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831"})]}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsxs("span",{className:"text-2xl font-bold text-gray-900",children:[a.utilizationRate,"%"]})})]}),e.jsx("p",{className:"text-sm text-gray-600",children:t("sacco.fleetUtilization")})]})]})]})})]})]})}export{q as default};
//# sourceMappingURL=SaccoDashboard-Brl2WEPT.js.map
