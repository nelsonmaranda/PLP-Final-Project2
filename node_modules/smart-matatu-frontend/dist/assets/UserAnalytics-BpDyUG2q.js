import{b as I,u as S,j as e,a as T}from"./index-Darj_tO4.js";import{r as i}from"./vendor-BKU87Gzz.js";import{R as f,A as b,B as k,l as C,_ as P,$ as H,M,h as U,y as v,d as _,o as D}from"./icons-l6XdvyrE.js";import"./router-BF-yxxER.js";const F=()=>{var p;const{state:l}=I(),{t:s}=S(),[a,R]=i.useState(null),[A,x]=i.useState(!0),[u,h]=i.useState(null),[n,o]=i.useState("7d"),[c,g]=i.useState("free"),w=t=>{if(c==="free"&&t!=="7d"){o("7d");return}o(t)},m=async()=>{var t,r,y,N;try{if(x(!0),h(null),(t=l.user)!=null&&t._id)try{const j=((r=(await T.getUserSubscription(l.user._id)).data)==null?void 0:r.planType)||"free";g(j),j==="free"&&n!=="7d"&&o("7d")}catch{g("free")}console.log(`Loading user analytics for: ${(y=l.user)==null?void 0:y._id}, period: ${n}`);const d={userId:((N=l.user)==null?void 0:N._id)||"",period:n,personalStats:{totalReports:12,totalRatings:8,favoriteRoutes:3,avgRatingGiven:4.2,reportsThisMonth:5,ratingsThisMonth:3},routeInsights:{mostReportedRoute:{routeName:"City Center to Airport",routeNumber:"34",reportCount:4,lastReport:"2 days ago"},bestRatedRoute:{routeName:"Downtown Express",routeNumber:"15",avgRating:4.8,totalRatings:156},recentActivity:[{routeName:"Route 34",routeNumber:"34",action:"Reported delay",date:"2 days ago"},{routeName:"Route 15",routeNumber:"15",action:"Rated 5 stars",date:"3 days ago"},{routeName:"Route 22",routeNumber:"22",action:"Reported safety issue",date:"1 week ago"}]},safetyInsights:{safetyReports:3,delayReports:6,breakdownReports:2,avgResponseTime:"2.5 hours",resolvedReports:8},recommendations:{suggestedRoutes:[{routeName:"Route 15",routeNumber:"15",reason:"Highly rated by users",avgRating:4.8},{routeName:"Route 28",routeNumber:"28",reason:"Reliable and punctual",avgRating:4.5}],safetyTips:["Avoid peak hours (7-9 AM, 5-7 PM) for better safety","Route 15 has the best safety record in your area","Report any safety concerns immediately for faster response"],peakHours:[{hour:"7:00-9:00 AM",recommendation:"High traffic, allow extra time"},{hour:"5:00-7:00 PM",recommendation:"Peak hours, consider alternative routes"}]}};R(d),console.log("User analytics data set:",d)}catch(d){h("Failed to load user analytics"),console.error("User analytics error:",d)}finally{x(!1)}};return i.useEffect(()=>{var t;(t=l.user)!=null&&t._id&&m()},[n,(p=l.user)==null?void 0:p._id]),A?e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx(f,{className:"w-8 h-8 animate-spin mx-auto mb-4 text-blue-600"}),e.jsx("p",{className:"text-gray-600",children:s("userAnalytics.loading")})]})}):u?e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx(b,{className:"w-8 h-8 mx-auto mb-4 text-red-600"}),e.jsx("p",{className:"text-red-600 mb-4",children:u}),e.jsx("button",{onClick:m,className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700",children:"Retry"})]})}):e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx("div",{className:"bg-white shadow-sm border-b",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"flex justify-between items-center py-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:s("userAnalytics.title")}),e.jsx("p",{className:"text-gray-600 mt-1",children:s("userAnalytics.subtitle")})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("select",{value:n,onChange:t=>w(t.target.value),className:"border border-gray-300 rounded-lg px-3 py-2 text-sm",children:[e.jsx("option",{value:"7d",children:s("userAnalytics.last7Days")}),e.jsxs("option",{value:"30d",disabled:c==="free",children:[s("userAnalytics.last30Days"),c==="free"?" (Pro)":""]}),e.jsxs("option",{value:"90d",disabled:c==="free",children:[s("userAnalytics.last90Days"),c==="free"?" (Pro)":""]})]}),e.jsxs("button",{onClick:m,className:"flex items-center space-x-2 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700",children:[e.jsx(f,{className:"w-4 h-4"}),e.jsx("span",{children:s("userAnalytics.refresh")})]})]})]})})}),e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:a&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsx("div",{className:"bg-white p-6 rounded-lg shadow",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:e.jsx(k,{className:"w-6 h-6 text-blue-600"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:s("userAnalytics.personalStats.totalReports")}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:a.personalStats.totalReports}),e.jsxs("p",{className:"text-xs text-gray-500",children:[a.personalStats.reportsThisMonth," ",s("userAnalytics.personalStats.reportsThisMonth")]})]})]})}),e.jsx("div",{className:"bg-white p-6 rounded-lg shadow",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-2 bg-yellow-100 rounded-lg",children:e.jsx(C,{className:"w-6 h-6 text-yellow-600"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:s("userAnalytics.personalStats.totalRatings")}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:a.personalStats.totalRatings}),e.jsxs("p",{className:"text-xs text-gray-500",children:[s("userAnalytics.personalStats.avgRating"),": ",a.personalStats.avgRatingGiven,"/5"]})]})]})}),e.jsx("div",{className:"bg-white p-6 rounded-lg shadow",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-2 bg-green-100 rounded-lg",children:e.jsx(P,{className:"w-6 h-6 text-green-600"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:s("userAnalytics.personalStats.favoriteRoutes")}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:a.personalStats.favoriteRoutes}),e.jsx("p",{className:"text-xs text-gray-500",children:s("userAnalytics.personalStats.savedRoutes")})]})]})}),e.jsx("div",{className:"bg-white p-6 rounded-lg shadow",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-2 bg-purple-100 rounded-lg",children:e.jsx(H,{className:"w-6 h-6 text-purple-600"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:s("userAnalytics.personalStats.activityScore")}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:"85%"}),e.jsx("p",{className:"text-xs text-gray-500",children:s("userAnalytics.personalStats.veryActiveUser")})]})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow",children:[e.jsxs("h3",{className:"text-lg font-medium text-gray-900 mb-4 flex items-center",children:[e.jsx(M,{className:"w-5 h-5 mr-2 text-blue-500"}),s("userAnalytics.routeInsights.title")]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"p-4 bg-red-50 rounded-lg",children:[e.jsx("h4",{className:"font-medium text-gray-900",children:s("userAnalytics.routeInsights.mostReportedRoute")}),e.jsxs("p",{className:"text-sm text-gray-600",children:[a.routeInsights.mostReportedRoute.routeNumber," - ",a.routeInsights.mostReportedRoute.routeName]}),e.jsxs("p",{className:"text-xs text-gray-500",children:[a.routeInsights.mostReportedRoute.reportCount," ",s("userAnalytics.routeInsights.reports"),", ",s("userAnalytics.routeInsights.last"),": ",a.routeInsights.mostReportedRoute.lastReport]})]}),e.jsxs("div",{className:"p-4 bg-green-50 rounded-lg",children:[e.jsx("h4",{className:"font-medium text-gray-900",children:s("userAnalytics.routeInsights.bestRatedRoute")}),e.jsxs("p",{className:"text-sm text-gray-600",children:[a.routeInsights.bestRatedRoute.routeNumber," - ",a.routeInsights.bestRatedRoute.routeName]}),e.jsxs("p",{className:"text-xs text-gray-500",children:[a.routeInsights.bestRatedRoute.avgRating,"/5 ",s("userAnalytics.routeInsights.stars")," (",a.routeInsights.bestRatedRoute.totalRatings," ",s("userAnalytics.routeInsights.ratings"),")"]})]})]})]}),e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow",children:[e.jsxs("h3",{className:"text-lg font-medium text-gray-900 mb-4 flex items-center",children:[e.jsx(U,{className:"w-5 h-5 mr-2 text-green-500"}),s("userAnalytics.recentActivity.title")]}),e.jsx("div",{className:"space-y-3",children:a.routeInsights.recentActivity.map((t,r)=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{children:[e.jsxs("p",{className:"text-sm font-medium text-gray-900",children:[t.routeNumber," - ",t.routeName]}),e.jsx("p",{className:"text-xs text-gray-500",children:t.action==="Reported delay"?s("userAnalytics.recentActivity.reportedDelay"):t.action==="Rated 5 stars"?s("userAnalytics.recentActivity.ratedStars"):t.action==="Reported safety issue"?s("userAnalytics.recentActivity.reportedSafetyIssue"):t.action})]}),e.jsx("span",{className:"text-xs text-gray-400",children:t.date})]},r))})]})]}),e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow",children:[e.jsxs("h3",{className:"text-lg font-medium text-gray-900 mb-4 flex items-center",children:[e.jsx(b,{className:"w-5 h-5 mr-2 text-orange-500"}),s("userAnalytics.safetyInsights.title")]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-2xl font-bold text-red-600",children:a.safetyInsights.safetyReports}),e.jsx("p",{className:"text-sm text-gray-500",children:s("userAnalytics.safetyInsights.safetyReports")})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-2xl font-bold text-yellow-600",children:a.safetyInsights.delayReports}),e.jsx("p",{className:"text-sm text-gray-500",children:s("userAnalytics.safetyInsights.delayReports")})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-2xl font-bold text-green-600",children:a.safetyInsights.resolvedReports}),e.jsx("p",{className:"text-sm text-gray-500",children:s("userAnalytics.safetyInsights.resolvedReports")})]})]}),e.jsx("div",{className:"mt-4 p-4 bg-blue-50 rounded-lg",children:e.jsxs("p",{className:"text-sm text-gray-600",children:[e.jsxs("strong",{children:[s("userAnalytics.safetyInsights.averageResponseTime"),":"]})," ",a.safetyInsights.avgResponseTime]})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow",children:[e.jsxs("h3",{className:"text-lg font-medium text-gray-900 mb-4 flex items-center",children:[e.jsx(v,{className:"w-5 h-5 mr-2 text-green-500"}),s("userAnalytics.recommendations.title")]}),e.jsx("div",{className:"space-y-3",children:a.recommendations.suggestedRoutes.map((t,r)=>e.jsx("div",{className:"p-3 bg-green-50 rounded-lg",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("p",{className:"font-medium text-gray-900",children:[t.routeNumber," - ",t.routeName]}),e.jsx("p",{className:"text-sm text-gray-600",children:t.reason==="Highly rated by users"?s("userAnalytics.recommendations.highlyRatedByUsers"):t.reason==="Reliable and punctual"?s("userAnalytics.recommendations.reliableAndPunctual"):t.reason})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:"text-sm font-medium text-green-600",children:[t.avgRating,"/5"]}),e.jsx("p",{className:"text-xs text-gray-500",children:s("userAnalytics.routeInsights.stars")})]})]})},r))})]}),e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow",children:[e.jsxs("h3",{className:"text-lg font-medium text-gray-900 mb-4 flex items-center",children:[e.jsx(_,{className:"w-5 h-5 mr-2 text-blue-500"}),s("userAnalytics.recommendations.safetyTips")]}),e.jsx("div",{className:"space-y-3",children:[s("userAnalytics.recommendations.avoidPeakHours"),s("userAnalytics.recommendations.bestSafetyRecord"),s("userAnalytics.recommendations.reportImmediately")].map((t,r)=>e.jsxs("div",{className:"flex items-start",children:[e.jsx(v,{className:"w-4 h-4 mr-2 text-green-500 mt-0.5"}),e.jsx("p",{className:"text-sm text-gray-600",children:t})]},r))})]})]}),e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow",children:[e.jsxs("h3",{className:"text-lg font-medium text-gray-900 mb-4 flex items-center",children:[e.jsx(D,{className:"w-5 h-5 mr-2 text-purple-500"}),s("userAnalytics.peakHours.title")]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:a.recommendations.peakHours.map((t,r)=>e.jsxs("div",{className:"p-4 bg-purple-50 rounded-lg",children:[e.jsx("p",{className:"font-medium text-gray-900",children:t.hour}),e.jsx("p",{className:"text-sm text-gray-600",children:t.recommendation==="High traffic, allow extra time"?s("userAnalytics.peakHours.highTraffic"):t.recommendation==="Peak hours, consider alternative routes"?s("userAnalytics.peakHours.peakHours"):t.recommendation})]},r))})]})]})})]})};export{F as default};
//# sourceMappingURL=UserAnalytics-BpDyUG2q.js.map
