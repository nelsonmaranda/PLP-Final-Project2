{"version":3,"file":"MapView-BbWpr6Dz.js","sources":["../../src/hooks/useOptimizedApi.ts","../../src/screens/MapView.tsx"],"sourcesContent":["import { useState, useEffect, useCallback, useRef } from 'react'\r\n\r\ninterface UseOptimizedApiOptions {\r\n  debounceMs?: number\r\n  cacheTime?: number\r\n  retryAttempts?: number\r\n  retryDelay?: number\r\n}\r\n\r\ninterface CacheEntry<T> {\r\n  data: T\r\n  timestamp: number\r\n  expiresAt: number\r\n}\r\n\r\nclass ApiCache {\r\n  private cache = new Map<string, CacheEntry<any>>()\r\n\r\n  set<T>(key: string, data: T, ttl: number): void {\r\n    const now = Date.now()\r\n    this.cache.set(key, {\r\n      data,\r\n      timestamp: now,\r\n      expiresAt: now + ttl\r\n    })\r\n  }\r\n\r\n  get<T>(key: string): T | null {\r\n    const entry = this.cache.get(key)\r\n    if (!entry) return null\r\n\r\n    if (Date.now() > entry.expiresAt) {\r\n      this.cache.delete(key)\r\n      return null\r\n    }\r\n\r\n    return entry.data\r\n  }\r\n\r\n  clear(): void {\r\n    this.cache.clear()\r\n  }\r\n\r\n  delete(key: string): void {\r\n    this.cache.delete(key)\r\n  }\r\n}\r\n\r\nconst apiCache = new ApiCache()\r\n\r\nexport function useOptimizedApi<T>(\r\n  apiCall: () => Promise<T>,\r\n  dependencies: any[] = [],\r\n  options: UseOptimizedApiOptions = {}\r\n) {\r\n  const {\r\n    debounceMs = 300,\r\n    cacheTime = 5 * 60 * 1000, // 5 minutes\r\n    retryAttempts = 3,\r\n    retryDelay = 1000\r\n  } = options\r\n\r\n  const [data, setData] = useState<T | null>(null)\r\n  const [loading, setLoading] = useState(false)\r\n  const [error, setError] = useState<Error | null>(null)\r\n  const [retryCount, setRetryCount] = useState(0)\r\n\r\n  const debounceRef = useRef<NodeJS.Timeout>()\r\n  const abortControllerRef = useRef<AbortController>()\r\n\r\n  const cacheKey = JSON.stringify(dependencies)\r\n\r\n  const executeApiCall = useCallback(async (isRetry = false) => {\r\n    // Check cache first\r\n    const cachedData = apiCache.get<T>(cacheKey)\r\n    if (cachedData && !isRetry) {\r\n      setData(cachedData)\r\n      return\r\n    }\r\n\r\n    // Cancel previous request\r\n    if (abortControllerRef.current) {\r\n      abortControllerRef.current.abort()\r\n    }\r\n\r\n    abortControllerRef.current = new AbortController()\r\n\r\n    try {\r\n      setLoading(true)\r\n      setError(null)\r\n\r\n      const result = await apiCall()\r\n      \r\n      // Cache the result\r\n      apiCache.set(cacheKey, result, cacheTime)\r\n      \r\n      setData(result)\r\n      setRetryCount(0)\r\n    } catch (err) {\r\n      const error = err as Error\r\n      \r\n      if (error.name === 'AbortError') {\r\n        return // Request was cancelled\r\n      }\r\n\r\n      setError(error)\r\n\r\n      // Retry logic\r\n      if (retryCount < retryAttempts) {\r\n        setRetryCount(prev => prev + 1)\r\n        setTimeout(() => {\r\n          executeApiCall(true)\r\n        }, retryDelay * Math.pow(2, retryCount)) // Exponential backoff\r\n      }\r\n    } finally {\r\n      setLoading(false)\r\n    }\r\n  }, [apiCall, cacheKey, cacheTime, retryAttempts, retryDelay, retryCount])\r\n\r\n  const debouncedExecute = useCallback(() => {\r\n    if (debounceRef.current) {\r\n      clearTimeout(debounceRef.current)\r\n    }\r\n\r\n    debounceRef.current = setTimeout(() => {\r\n      executeApiCall()\r\n    }, debounceMs)\r\n  }, [executeApiCall, debounceMs])\r\n\r\n  useEffect(() => {\r\n    debouncedExecute()\r\n\r\n    return () => {\r\n      if (debounceRef.current) {\r\n        clearTimeout(debounceRef.current)\r\n      }\r\n      if (abortControllerRef.current) {\r\n        abortControllerRef.current.abort()\r\n      }\r\n    }\r\n  }, [debouncedExecute])\r\n\r\n  const refetch = useCallback(() => {\r\n    apiCache.delete(cacheKey)\r\n    executeApiCall()\r\n  }, [cacheKey, executeApiCall])\r\n\r\n  const clearCache = useCallback(() => {\r\n    apiCache.clear()\r\n  }, [])\r\n\r\n  return {\r\n    data,\r\n    loading,\r\n    error,\r\n    retryCount,\r\n    refetch,\r\n    clearCache\r\n  }\r\n}\r\n\r\nexport default useOptimizedApi\r\n","import { useState, useCallback } from 'react'\r\nimport { MapContainer, TileLayer, Marker, Popup, Polyline } from 'react-leaflet'\r\nimport { MapPin, Clock, Star, Users, Filter, List, AlertCircle } from 'lucide-react'\r\nimport 'leaflet/dist/leaflet.css'\r\nimport apiService from '../services/api'\r\nimport { RouteWithScores } from '../types'\r\nimport LoadingSpinner from '../components/LoadingSpinner'\r\nimport useOptimizedApi from '../hooks/useOptimizedApi'\r\n\r\n// Fix for default markers in react-leaflet\r\nimport L from 'leaflet'\r\n\r\nconst DefaultIcon = L.icon({\r\n  iconUrl: 'https://unpkg.com/leaflet@1.9.4/dist/images/marker-icon.png',\r\n  shadowUrl: 'https://unpkg.com/leaflet@1.9.4/dist/images/marker-shadow.png',\r\n  iconSize: [25, 41],\r\n  iconAnchor: [12, 41],\r\n  popupAnchor: [1, -34],\r\n  shadowSize: [41, 41]\r\n})\r\n\r\n// Only set the default icon if L is available (not in test environment)\r\nif (typeof L !== 'undefined' && L.Marker) {\r\n  L.Marker.prototype.options.icon = DefaultIcon\r\n}\r\n\r\nexport default function MapView() {\r\n  const [selectedRoute, setSelectedRoute] = useState<RouteWithScores | null>(null)\r\n  const [showFilters, setShowFilters] = useState(false)\r\n  const [showListView, setShowListView] = useState(false)\r\n  const [filters, setFilters] = useState({\r\n    highReliability: true,\r\n    safeRoutes: true,\r\n    lowFare: false\r\n  })\r\n\r\n  // Nairobi coordinates\r\n  const nairobiCenter: [number, number] = [-1.2921, 36.8219]\r\n\r\n  // Optimized API call for routes\r\n  const loadRoutes = useCallback(async () => {\r\n    const response = await apiService.getRoutes({\r\n      page: 1,\r\n      limit: 50,\r\n      sort: 'createdAt',\r\n      order: 'desc'\r\n    })\r\n\r\n    if (response.success && response.data) {\r\n      // Routes already include scores from the backend\r\n      return response.data.routes\r\n    }\r\n    return []\r\n  }, [])\r\n\r\n  const { data: routes, loading: isLoading, error, refetch } = useOptimizedApi(\r\n    loadRoutes,\r\n    [filters], // Re-fetch when filters change\r\n    {\r\n      debounceMs: 500,\r\n      cacheTime: 2 * 60 * 1000, // 2 minutes cache\r\n      retryAttempts: 2\r\n    }\r\n  )\r\n\r\n  const filteredRoutes = (() => {\r\n    try {\r\n      return (routes || []).filter(route => {\r\n        // Only apply filters if they are checked\r\n        if (filters.highReliability) {\r\n          if (!route.score || typeof route.score.reliability !== 'number' || route.score.reliability < 4) {\r\n            return false\r\n          }\r\n        }\r\n        if (filters.safeRoutes) {\r\n          if (!route.score || typeof route.score.safety !== 'number' || route.score.safety < 4) {\r\n            return false\r\n          }\r\n        }\r\n        if (filters.lowFare) {\r\n          if (typeof route.fare !== 'number' || route.fare >= 50) {\r\n            return false\r\n          }\r\n        }\r\n        return true\r\n      })\r\n    } catch (error) {\r\n      console.error('Error filtering routes:', error)\r\n      // Return all routes if filtering fails\r\n      return routes || []\r\n    }\r\n  })()\r\n\r\n  const getScoreColor = (score: number) => {\r\n    if (score >= 4.5) return '#22c55e' // green\r\n    if (score >= 3.5) return '#f59e0b' // yellow\r\n    if (score >= 2.5) return '#f97316' // orange\r\n    return '#ef4444' // red\r\n  }\r\n\r\n  const getRouteColor = (route: RouteWithScores) => {\r\n    if (route.score) {\r\n      return getScoreColor(route.score.overall)\r\n    }\r\n    return '#3b82f6' // default blue\r\n  }\r\n\r\n  if (isLoading) {\r\n    return (\r\n      <div className=\"min-h-screen flex items-center justify-center\">\r\n        <div className=\"text-center\">\r\n          <LoadingSpinner />\r\n          <p className=\"text-gray-600 mt-4\">Loading routes...</p>\r\n        </div>\r\n      </div>\r\n    )\r\n  }\r\n\r\n  if (error) {\r\n    return (\r\n      <div className=\"min-h-screen flex items-center justify-center\">\r\n        <div className=\"text-center\">\r\n          <AlertCircle className=\"h-12 w-12 text-red-500 mx-auto mb-4\" />\r\n          <p className=\"text-red-600 mb-4\">{error?.message || 'An error occurred'}</p>\r\n          <button\r\n            onClick={refetch}\r\n            className=\"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700\"\r\n          >\r\n            Try Again\r\n          </button>\r\n        </div>\r\n      </div>\r\n    )\r\n  }\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-gray-50\">\r\n      <div className=\"container py-6\">\r\n        <div className=\"flex flex-col lg:flex-row gap-6\">\r\n          {/* Map Container */}\r\n          <div className=\"flex-1\">\r\n            <div className=\"card\">\r\n              <div className=\"card-header\">\r\n                <div className=\"flex justify-between items-center\">\r\n                  <h2 className=\"card-title\">Nairobi Matatu Routes</h2>\r\n                  <div className=\"flex space-x-2\">\r\n                    <button \r\n                      className={`btn btn-sm ${showFilters ? 'btn-primary' : 'btn-outline'}`}\r\n                      onClick={() => setShowFilters(!showFilters)}\r\n                      aria-label=\"Toggle filter panel\"\r\n                      aria-pressed={showFilters}\r\n                    >\r\n                      <Filter className=\"w-4 h-4 mr-2\" aria-hidden=\"true\" />\r\n                      Filter\r\n                    </button>\r\n                    <button \r\n                      className={`btn btn-sm ${showListView ? 'btn-primary' : 'btn-outline'}`}\r\n                      onClick={() => setShowListView(!showListView)}\r\n                      aria-label=\"Toggle list view\"\r\n                      aria-pressed={showListView}\r\n                    >\r\n                      <List className=\"w-4 h-4 mr-2\" aria-hidden=\"true\" />\r\n                      List\r\n                    </button>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n              <div className=\"card-content p-0\">\r\n                {/* Collapsible Filters */}\r\n                {showFilters && (\r\n                  <div className=\"p-4 bg-gray-50 border-b\">\r\n                    <div className=\"space-y-3\">\r\n                      <div className=\"flex items-center space-x-2\">\r\n                        <Filter className=\"h-4 w-4 text-gray-500\" aria-hidden=\"true\" />\r\n                        <span className=\"text-sm font-medium text-gray-700\">Quick Filters</span>\r\n                      </div>\r\n                      \r\n                      <fieldset className=\"flex flex-wrap gap-4\">\r\n                        <legend className=\"sr-only\">Route filters</legend>\r\n                        <label className=\"flex items-center\">\r\n                          <input \r\n                            type=\"checkbox\" \r\n                            className=\"rounded border-gray-300\" \r\n                            checked={filters.highReliability}\r\n                            onChange={(e) => setFilters(prev => ({ ...prev, highReliability: e.target.checked }))}\r\n                          />\r\n                          <span className=\"ml-2 text-sm text-gray-600\">High Reliability (4+ stars)</span>\r\n                        </label>\r\n                        <label className=\"flex items-center\">\r\n                          <input \r\n                            type=\"checkbox\" \r\n                            className=\"rounded border-gray-300\" \r\n                            checked={filters.safeRoutes}\r\n                            onChange={(e) => setFilters(prev => ({ ...prev, safeRoutes: e.target.checked }))}\r\n                          />\r\n                          <span className=\"ml-2 text-sm text-gray-600\">Safe Routes (4+ stars)</span>\r\n                        </label>\r\n                        <label className=\"flex items-center\">\r\n                          <input \r\n                            type=\"checkbox\" \r\n                            className=\"rounded border-gray-300\" \r\n                            checked={filters.lowFare}\r\n                            onChange={(e) => setFilters(prev => ({ ...prev, lowFare: e.target.checked }))}\r\n                          />\r\n                          <span className=\"ml-2 text-sm text-gray-600\">Low Fare (Under 50 KES)</span>\r\n                        </label>\r\n                      </fieldset>\r\n                    </div>\r\n                  </div>\r\n                )}\r\n\r\n                {/* Map or List View */}\r\n                {showListView ? (\r\n                  <div className=\"p-4\">\r\n                    <div className=\"space-y-4\">\r\n                      <div className=\"text-sm text-gray-600 mb-4\">\r\n                        {filteredRoutes.length} of {routes?.length || 0} routes\r\n                      </div>\r\n                      {filteredRoutes.map((route) => (\r\n                        <div \r\n                          key={route._id}\r\n                          className={`p-4 border rounded-lg cursor-pointer transition-colors ${\r\n                            selectedRoute?._id === route._id \r\n                              ? 'border-primary-500 bg-primary-50' \r\n                              : 'border-gray-200 hover:border-gray-300'\r\n                          }`}\r\n                          onClick={() => setSelectedRoute(route)}\r\n                        >\r\n                          <div className=\"flex justify-between items-start\">\r\n                            <div className=\"flex-1\">\r\n                              <h4 className=\"font-medium text-gray-900\">{route.name}</h4>\r\n                              <p className=\"text-sm text-gray-600\">{route.operator} - Route {route.routeNumber}</p>\r\n                              <div className=\"flex items-center mt-2 space-x-4 text-xs text-gray-500\">\r\n                                <div className=\"flex items-center\">\r\n                                  <Star className=\"w-3 h-3 text-yellow-500 mr-1\" />\r\n                                  <span>{route.score?.overall?.toFixed(1) || 'N/A'}</span>\r\n                                </div>\r\n                                <div className=\"flex items-center\">\r\n                                  <Clock className=\"w-3 h-3 text-blue-500 mr-1\" />\r\n                                  <span>{route.operatingHours.start} - {route.operatingHours.end}</span>\r\n                                </div>\r\n                              </div>\r\n                            </div>\r\n                            <div className=\"text-right\">\r\n                              <div className=\"text-lg font-semibold text-gray-900\">\r\n                                KES {route.fare}\r\n                              </div>\r\n                              <div \r\n                                className=\"w-4 h-4 rounded-full mt-1 ml-auto\" \r\n                                style={{ backgroundColor: getRouteColor(route) }}\r\n                              ></div>\r\n                            </div>\r\n                          </div>\r\n                        </div>\r\n                      ))}\r\n                    </div>\r\n                  </div>\r\n                ) : (\r\n                  <div className=\"map-container h-96\" role=\"img\" aria-label=\"Interactive map showing Nairobi matatu routes\">\r\n                    <MapContainer\r\n                      center={nairobiCenter}\r\n                      zoom={11}\r\n                      style={{ height: '100%', width: '100%' }}\r\n                    >\r\n                    <TileLayer\r\n                      attribution='&copy; <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors'\r\n                      url=\"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\"\r\n                    />\r\n                    \r\n                    {/* Render routes */}\r\n                    {filteredRoutes.map((route) => {\r\n                      try {\r\n                        // Safely process route path - convert flattened array to coordinate pairs\r\n                        const routePath: [number, number][] = []\r\n                        if (route.path && Array.isArray(route.path) && route.path.length > 0) {\r\n                          for (let i = 0; i < route.path.length; i += 2) {\r\n                            if (i + 1 < route.path.length) {\r\n                              const lat = route.path[i + 1]\r\n                              const lng = route.path[i]\r\n                              if (typeof lat === 'number' && typeof lng === 'number' && \r\n                                  !isNaN(lat) && !isNaN(lng)) {\r\n                                routePath.push([lat, lng])\r\n                              }\r\n                            }\r\n                          }\r\n                        }\r\n\r\n                        return (\r\n                          <div key={route._id}>\r\n                            {/* Route path */}\r\n                            {routePath.length > 0 && (\r\n                              <Polyline\r\n                                positions={routePath}\r\n                                color={getRouteColor(route)}\r\n                                weight={selectedRoute?._id === route._id ? 6 : 4}\r\n                                opacity={selectedRoute?._id === route._id ? 0.8 : 0.6}\r\n                              />\r\n                            )}\r\n                        \r\n                            {/* Route stops */}\r\n                            {route.stops && Array.isArray(route.stops) && route.stops.map((stop, index) => {\r\n                              try {\r\n                                const coords = stop.coordinates\r\n                                if (!coords || !Array.isArray(coords) || coords.length !== 2) {\r\n                                  return null\r\n                                }\r\n                                const [lat, lng] = coords\r\n                                if (typeof lat !== 'number' || typeof lng !== 'number' || \r\n                                    isNaN(lat) || isNaN(lng)) {\r\n                                  return null\r\n                                }\r\n                                \r\n                                return (\r\n                                  <Marker\r\n                                    key={index}\r\n                                    position={[lat, lng]}\r\n                                    icon={DefaultIcon}\r\n                                  >\r\n                                    <Popup>\r\n                                      <div className=\"p-2\">\r\n                                        <h3 className=\"font-semibold\">{stop.name}</h3>\r\n                                        <p className=\"text-sm text-gray-600\">{route.name}</p>\r\n                                        <p className=\"text-xs text-gray-500 mt-1\">{route.operator}</p>\r\n                                        <div className=\"mt-2 flex items-center space-x-4 text-xs text-gray-500\">\r\n                                          <div className=\"flex items-center\">\r\n                                            <Star className=\"h-3 w-3 mr-1 text-yellow-400\" />\r\n                                            {route.score?.overall?.toFixed(1) || 'N/A'}\r\n                                          </div>\r\n                                          <div className=\"flex items-center\">\r\n                                            <Users className=\"h-3 w-3 mr-1\" />\r\n                                            {route.score?.safety?.toFixed(1) || 'N/A'}\r\n                                          </div>\r\n                                          <div className=\"text-gray-600\">\r\n                                            {route.fare} KES\r\n                                          </div>\r\n                                        </div>\r\n                                      </div>\r\n                                    </Popup>\r\n                                  </Marker>\r\n                                )\r\n                              } catch (error) {\r\n                                console.error('Error rendering stop:', error)\r\n                                return null\r\n                              }\r\n                            })}\r\n                          </div>\r\n                        )\r\n                      } catch (error) {\r\n                        console.error('Error rendering route:', error)\r\n                        return null\r\n                      }\r\n                    })}\r\n                    </MapContainer>\r\n                  </div>\r\n                )}\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          {/* Route List Sidebar */}\r\n          <div className=\"w-full lg:w-80\">\r\n            <div className=\"card\">\r\n              <div className=\"card-header\">\r\n                <h3 className=\"text-lg font-semibold\">Available Routes</h3>\r\n                <p className=\"text-sm text-gray-600\">\r\n                  {filteredRoutes.length} of {routes?.length || 0} routes\r\n                </p>\r\n              </div>\r\n              \r\n              {/* Filters */}\r\n              <div className=\"p-4 border-b\">\r\n                <div className=\"space-y-3\">\r\n                  <div className=\"flex items-center space-x-2\">\r\n                    <Filter className=\"h-4 w-4 text-gray-500\" aria-hidden=\"true\" />\r\n                    <span className=\"text-sm font-medium text-gray-700\">Filters</span>\r\n                  </div>\r\n                  \r\n                  <fieldset className=\"space-y-2\">\r\n                    <legend className=\"sr-only\">Route filters</legend>\r\n                    <label className=\"flex items-center\">\r\n                      <input \r\n                        type=\"checkbox\" \r\n                        className=\"rounded border-gray-300\" \r\n                        checked={filters.highReliability}\r\n                        onChange={(e) => setFilters(prev => ({ ...prev, highReliability: e.target.checked }))}\r\n                        aria-describedby=\"high-reliability-desc\"\r\n                      />\r\n                      <span className=\"ml-2 text-sm text-gray-600\">High Reliability (4+ stars)</span>\r\n                    </label>\r\n                    <label className=\"flex items-center\">\r\n                      <input \r\n                        type=\"checkbox\" \r\n                        className=\"rounded border-gray-300\" \r\n                        checked={filters.safeRoutes}\r\n                        onChange={(e) => setFilters(prev => ({ ...prev, safeRoutes: e.target.checked }))}\r\n                        aria-describedby=\"safe-routes-desc\"\r\n                      />\r\n                      <span className=\"ml-2 text-sm text-gray-600\">Safe Routes (4+ stars)</span>\r\n                    </label>\r\n                    <label className=\"flex items-center\">\r\n                      <input \r\n                        type=\"checkbox\" \r\n                        className=\"rounded border-gray-300\" \r\n                        checked={filters.lowFare}\r\n                        onChange={(e) => setFilters(prev => ({ ...prev, lowFare: e.target.checked }))}\r\n                        aria-describedby=\"low-fare-desc\"\r\n                      />\r\n                      <span className=\"ml-2 text-sm text-gray-600\">Low Fare (Under 50 KES)</span>\r\n                    </label>\r\n                  </fieldset>\r\n                </div>\r\n              </div>\r\n              \r\n              <div className=\"card-content p-0\">\r\n                <div className=\"divide-y divide-gray-200\">\r\n                  {filteredRoutes.map((route) => (\r\n                    <div\r\n                      key={route._id}\r\n                      className={`p-4 cursor-pointer hover:bg-gray-50 transition-colors ${\r\n                        selectedRoute?._id === route._id ? 'bg-primary-50 border-r-4 border-primary-500' : ''\r\n                      }`}\r\n                      onClick={() => setSelectedRoute(route)}\r\n                      role=\"button\"\r\n                      tabIndex={0}\r\n                      onKeyDown={(e) => {\r\n                        if (e.key === 'Enter' || e.key === ' ') {\r\n                          e.preventDefault()\r\n                          setSelectedRoute(route)\r\n                        }\r\n                      }}\r\n                      aria-label={`Select route ${route.name} by ${route.operator}`}\r\n                      aria-pressed={selectedRoute?._id === route._id}\r\n                    >\r\n                      <div className=\"flex items-start justify-between\">\r\n                        <div className=\"flex-1\">\r\n                          <h4 className=\"font-medium text-gray-900\">{route.name}</h4>\r\n                          <p className=\"text-sm text-gray-600 mt-1\">{route.operator}</p>\r\n                          <div className=\"flex items-center space-x-4 mt-2 text-sm text-gray-600\">\r\n                            <div className=\"flex items-center\">\r\n                              <Star className=\"w-4 h-4 text-yellow-500 mr-1\" aria-hidden=\"true\" />\r\n                              <span aria-label={`Overall rating: ${route.score?.overall?.toFixed(1) || 'N/A'} stars`}>\r\n                                {route.score?.overall?.toFixed(1) || 'N/A'}\r\n                              </span>\r\n                            </div>\r\n                            <div className=\"flex items-center\">\r\n                              <Clock className=\"w-4 h-4 text-blue-500 mr-1\" aria-hidden=\"true\" />\r\n                              <span aria-label={`Operating hours: ${route.operatingHours.start} to ${route.operatingHours.end}`}>\r\n                                {route.operatingHours.start} - {route.operatingHours.end}\r\n                              </span>\r\n                            </div>\r\n                            <div className=\"flex items-center\">\r\n                              <Users className=\"w-4 h-4 text-green-500 mr-1\" aria-hidden=\"true\" />\r\n                              <span aria-label={`Safety rating: ${route.score?.safety?.toFixed(1) || 'N/A'} stars`}>\r\n                                {route.score?.safety?.toFixed(1) || 'N/A'}\r\n                              </span>\r\n                            </div>\r\n                          </div>\r\n                        </div>\r\n                        <div className=\"text-right\">\r\n                          <div className=\"text-lg font-semibold text-gray-900\">\r\n                            KES {route.fare}\r\n                          </div>\r\n                          <div \r\n                            className=\"w-4 h-4 rounded-full mt-1\" \r\n                            style={{ backgroundColor: getRouteColor(route) }}\r\n                            aria-label={`Route quality indicator: ${getRouteColor(route)}`}\r\n                          ></div>\r\n                        </div>\r\n                      </div>\r\n                    </div>\r\n                  ))}\r\n                </div>\r\n              </div>\r\n            </div>\r\n\r\n            {/* Selected Route Details */}\r\n            {selectedRoute && (\r\n              <div className=\"card mt-4\" role=\"region\" aria-labelledby=\"route-details-heading\">\r\n                <div className=\"card-header\">\r\n                  <h3 id=\"route-details-heading\" className=\"text-lg font-semibold\">Route Details</h3>\r\n                </div>\r\n                <div className=\"card-content\">\r\n                  <div className=\"space-y-4\">\r\n                    <div>\r\n                      <h4 className=\"font-medium text-gray-900\">{selectedRoute.name}</h4>\r\n                      <p className=\"text-sm text-gray-600\">{selectedRoute.operator}</p>\r\n                      <p className=\"text-xs text-gray-500 mt-1\">Real-time updates available</p>\r\n                    </div>\r\n                    \r\n                    <div className=\"grid grid-cols-2 gap-4\">\r\n                      <div className=\"text-center p-3 bg-gray-50 rounded-lg\">\r\n                        <div className=\"text-2xl font-bold text-primary-600\" aria-label={`Reliability score: ${selectedRoute.score?.reliability?.toFixed(1) || 'N/A'} out of 5`}>\r\n                          {selectedRoute.score?.reliability?.toFixed(1) || 'N/A'}\r\n                        </div>\r\n                        <div className=\"text-sm text-gray-600\">Reliability</div>\r\n                      </div>\r\n                      <div className=\"text-center p-3 bg-gray-50 rounded-lg\">\r\n                        <div className=\"text-2xl font-bold text-secondary-600\" aria-label={`Safety score: ${selectedRoute.score?.safety?.toFixed(1) || 'N/A'} out of 5`}>\r\n                          {selectedRoute.score?.safety?.toFixed(1) || 'N/A'}\r\n                        </div>\r\n                        <div className=\"text-sm text-gray-600\">Safety</div>\r\n                      </div>\r\n                    </div>\r\n                    \r\n                    <dl className=\"space-y-2\">\r\n                      <div className=\"flex justify-between\">\r\n                        <dt className=\"text-gray-600\">Fare:</dt>\r\n                        <dd className=\"font-medium\">KES {selectedRoute.fare}</dd>\r\n                      </div>\r\n                      <div className=\"flex justify-between\">\r\n                        <dt className=\"text-gray-600\">Operating Hours:</dt>\r\n                        <dd className=\"font-medium\">{selectedRoute.operatingHours.start} - {selectedRoute.operatingHours.end}</dd>\r\n                      </div>\r\n                      <div className=\"flex justify-between\">\r\n                        <dt className=\"text-gray-600\">Stops:</dt>\r\n                        <dd className=\"font-medium\">{selectedRoute.stops.length} stops</dd>\r\n                      </div>\r\n                    </dl>\r\n                    \r\n                    <button \r\n                      className=\"btn btn-primary w-full\"\r\n                      aria-label=\"View selected route on map\"\r\n                    >\r\n                      <MapPin className=\"w-4 h-4 mr-2\" aria-hidden=\"true\" />\r\n                      View on Map\r\n                    </button>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            )}\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n"],"names":["ApiCache","__publicField","key","data","ttl","now","entry","apiCache","useOptimizedApi","apiCall","dependencies","options","debounceMs","cacheTime","retryAttempts","retryDelay","setData","useState","loading","setLoading","error","setError","retryCount","setRetryCount","debounceRef","useRef","abortControllerRef","cacheKey","executeApiCall","useCallback","isRetry","cachedData","result","err","prev","debouncedExecute","useEffect","refetch","clearCache","DefaultIcon","L","MapView","selectedRoute","setSelectedRoute","showFilters","setShowFilters","showListView","setShowListView","filters","setFilters","nairobiCenter","loadRoutes","response","apiService","routes","isLoading","filteredRoutes","route","getScoreColor","score","getRouteColor","jsxs","jsx","LoadingSpinner","AlertCircle","Filter","List","e","Star","_b","_a","Clock","MapContainer","TileLayer","routePath","i","lat","lng","Polyline","stop","index","coords","Marker","Popup","Users","_d","_c","_f","_e","_h","_g","MapPin"],"mappings":"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"}