import{b as D,u as R,j as e,a as A}from"./index-BRy-12qz.js";import{r as l}from"./vendor-BKU87Gzz.js";import{R as y,A as x,B as S,M as m,_ as j,$ as N,E as k,l as C,T as P,Y as M,h as T}from"./icons-B9e0n2uV.js";import"./router-BF-yxxER.js";const O=()=>{var u;const{state:v}=D(),{t:a}=R(),[t,h]=l.useState(null),[b,p]=l.useState(!0),[g,n]=l.useState(null),[i,f]=l.useState("7d"),[r,w]=l.useState("overview"),d=((u=v.user)==null?void 0:u.organization)||"Default SACCO",o=async()=>{try{p(!0),n(null),console.log(`Loading SACCO analytics for: ${d}, period: ${i}`);const s=await A.getSaccoAnalytics(d,i);console.log("SACCO analytics response:",s),s.success?(h(s.data),console.log("SACCO analytics data set:",s.data)):(n("Failed to load SACCO analytics"),console.error("SACCO analytics failed:",s))}catch(s){console.error("SACCO analytics error:",s),console.log("Attempting to load with sample data...");try{h({saccoName:d,period:i,routeMetrics:{totalRoutes:3,activeRoutes:2,routePerformance:[{_id:"sample1",routeName:"Route 1",routeNumber:"1",avgRating:4.2,totalRatings:15,avgReliability:4,avgSafety:4.5,avgPunctuality:3.8,avgComfort:4.1},{_id:"sample2",routeName:"Route 2",routeNumber:"2",avgRating:3.8,totalRatings:12,avgReliability:3.5,avgSafety:4,avgPunctuality:3.9,avgComfort:3.7}]},reportMetrics:{totalReports:5,reportsByType:[{type:"delay",count:3},{type:"safety",count:2}],reportsBySeverity:[{severity:"medium",count:3},{severity:"high",count:2}],avgReportsPerDay:"0.71"},performanceTrends:[],geographicInsights:{hotspots:[],totalLocations:0},timeAnalytics:{reportsByHour:[],peakHours:[]},revenueAnalytics:{dailyRevenue:[],totalRevenue:0,avgDailyRevenue:"0"},competitiveAnalysis:{saccoRanking:1,totalSaccos:1,marketPosition:[],performanceVsMarket:{saccoReports:5,marketAvg:"5.00"}}}),n("Using sample data - real data unavailable"),console.log("Loaded sample data successfully")}catch(c){n("Failed to load SACCO analytics"),console.error("Sample data also failed:",c)}}finally{p(!1)}};return l.useEffect(()=>{o()},[i,d]),b?e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx(y,{className:"w-8 h-8 animate-spin mx-auto mb-4 text-blue-600"}),e.jsx("p",{className:"text-gray-600",children:a("saccoDashboard.loading")})]})}):g?e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx(x,{className:"w-8 h-8 mx-auto mb-4 text-red-600"}),e.jsx("p",{className:"text-red-600 mb-4",children:g}),e.jsx("button",{onClick:o,className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700",children:"Retry"})]})}):e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx("div",{className:"bg-white shadow-sm border-b",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"flex justify-between items-center py-6",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-bold text-gray-900",children:[d," ",a("saccoDashboard.dashboardTitle")]}),e.jsx("p",{className:"text-gray-600 mt-1",children:a("saccoDashboard.subtitle")}),e.jsx("p",{className:"text-sm text-blue-600 mt-1",children:a("saccoDashboard.dataSource")})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("select",{value:i,onChange:s=>f(s.target.value),className:"border border-gray-300 rounded-lg px-3 py-2 text-sm",children:[e.jsx("option",{value:"7d",children:a("saccoDashboard.last7Days")}),e.jsx("option",{value:"30d",children:a("saccoDashboard.last30Days")}),e.jsx("option",{value:"90d",children:a("saccoDashboard.last90Days")})]}),e.jsxs("button",{onClick:o,className:"flex items-center space-x-2 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700",children:[e.jsx(y,{className:"w-4 h-4"}),e.jsx("span",{children:a("saccoDashboard.refresh")})]})]})]})})}),e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:e.jsx("div",{className:"border-b border-gray-200",children:e.jsx("nav",{className:"-mb-px flex space-x-8",children:[{id:"overview",name:a("saccoDashboard.overview.title"),icon:S},{id:"routes",name:a("saccoDashboard.routePerformance.title"),icon:m},{id:"reports",name:a("saccoDashboard.incidentReports.title"),icon:x},{id:"revenue",name:a("saccoDashboard.revenueAnalytics.title"),icon:j},{id:"competitive",name:a("saccoDashboard.marketPosition.title"),icon:N},{id:"insights",name:a("saccoDashboard.geographicInsights.title"),icon:k}].map(s=>e.jsxs("button",{onClick:()=>w(s.id),className:`flex items-center space-x-2 py-4 px-1 border-b-2 font-medium text-sm ${r===s.id?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[e.jsx(s.icon,{className:"w-4 h-4"}),e.jsx("span",{children:s.name})]},s.id))})})}),e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:t&&e.jsxs(e.Fragment,{children:[r==="overview"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsx("div",{className:"bg-white p-6 rounded-lg shadow",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:e.jsx(m,{className:"w-6 h-6 text-blue-600"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:a("saccoDashboard.totalRoutes")}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:t.routeMetrics.totalRoutes}),e.jsxs("p",{className:"text-xs text-gray-500",children:[t.routeMetrics.activeRoutes," ",a("saccoDashboard.active")]})]})]})}),e.jsx("div",{className:"bg-white p-6 rounded-lg shadow",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-2 bg-green-100 rounded-lg",children:e.jsx(C,{className:"w-6 h-6 text-green-600"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:a("saccoDashboard.avgRating")}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:t.routeMetrics.routePerformance.length>0?(t.routeMetrics.routePerformance.reduce((s,c)=>s+c.avgRating,0)/t.routeMetrics.routePerformance.length).toFixed(1):"N/A"}),e.jsxs("p",{className:"text-xs text-gray-500",children:[a("saccoDashboard.outOf")," 5.0"]})]})]})}),e.jsx("div",{className:"bg-white p-6 rounded-lg shadow",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-2 bg-yellow-100 rounded-lg",children:e.jsx(x,{className:"w-6 h-6 text-yellow-600"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:a("saccoDashboard.totalReports")}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:t.reportMetrics.totalReports}),e.jsxs("p",{className:"text-xs text-gray-500",children:[t.reportMetrics.avgReportsPerDay," ",a("saccoDashboard.perDay")]})]})]})}),e.jsx("div",{className:"bg-white p-6 rounded-lg shadow",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-2 bg-purple-100 rounded-lg",children:e.jsx(N,{className:"w-6 h-6 text-purple-600"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:a("saccoDashboard.marketRank")}),e.jsxs("p",{className:"text-2xl font-bold text-gray-900",children:["#",t.competitiveAnalysis.saccoRanking]}),e.jsxs("p",{className:"text-xs text-gray-500",children:[a("saccoDashboard.ofSaccos")," ",t.competitiveAnalysis.totalSaccos," ",a("saccoDashboard.ofSaccos")]})]})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:a("saccoDashboard.reportsByType")}),e.jsx("div",{className:"space-y-3",children:t.reportMetrics.reportsByType.map(s=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-3 h-3 bg-red-500 rounded-full mr-3"}),e.jsx("span",{className:"text-sm font-medium text-gray-900 capitalize",children:s.type.replace("_"," ")})]}),e.jsx("span",{className:"text-sm text-gray-500",children:s.count})]},s.type))})]}),e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:a("saccoDashboard.reportsBySeverity")}),e.jsx("div",{className:"space-y-3",children:t.reportMetrics.reportsBySeverity.map(s=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:`w-3 h-3 rounded-full mr-3 ${s.severity==="critical"?"bg-red-600":s.severity==="high"?"bg-orange-500":s.severity==="medium"?"bg-yellow-500":"bg-green-500"}`}),e.jsx("span",{className:"text-sm font-medium text-gray-900 capitalize",children:s.severity})]}),e.jsx("span",{className:"text-sm text-gray-500",children:s.count})]},s.severity))})]})]})]}),r==="routes"&&e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"bg-white shadow rounded-lg",children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:e.jsx("h3",{className:"text-lg leading-6 font-medium text-gray-900",children:a("saccoDashboard.routePerformanceAnalysis")})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:a("saccoDashboard.route")}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:a("saccoDashboard.overallRating")}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:a("saccoDashboard.safety")}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:a("saccoDashboard.punctuality")}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:a("saccoDashboard.comfort")}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:a("saccoDashboard.totalRatings")})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:t.routeMetrics.routePerformance.map(s=>e.jsxs("tr",{children:[e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:[s.routeNumber," - ",s.routeName]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("span",{className:"text-yellow-400",children:"â˜…"}),e.jsx("span",{className:"ml-1",children:s.avgRating.toFixed(1)})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:s.avgSafety.toFixed(1)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:s.avgPunctuality.toFixed(1)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:s.avgComfort.toFixed(1)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:s.totalRatings})]},s._id))})]})})]})}),r==="revenue"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsx("div",{className:"bg-white p-6 rounded-lg shadow",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-2 bg-green-100 rounded-lg",children:e.jsx(j,{className:"w-6 h-6 text-green-600"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:a("saccoDashboard.totalRevenue")}),e.jsxs("p",{className:"text-2xl font-bold text-gray-900",children:["KES ",t.revenueAnalytics.totalRevenue.toLocaleString()]})]})]})}),e.jsx("div",{className:"bg-white p-6 rounded-lg shadow",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:e.jsx(P,{className:"w-6 h-6 text-blue-600"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:a("saccoDashboard.avgDailyRevenue")}),e.jsxs("p",{className:"text-2xl font-bold text-gray-900",children:["KES ",t.revenueAnalytics.avgDailyRevenue]})]})]})}),e.jsx("div",{className:"bg-white p-6 rounded-lg shadow",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-2 bg-purple-100 rounded-lg",children:e.jsx(M,{className:"w-6 h-6 text-purple-600"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:a("saccoDashboard.revenueDays")}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:t.revenueAnalytics.dailyRevenue.length})]})]})})]}),e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:a("saccoDashboard.dailyRevenueTrends")}),e.jsx("div",{className:"space-y-3",children:t.revenueAnalytics.dailyRevenue.slice(0,10).map(s=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:s._id.day}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("span",{className:"text-sm text-gray-500",children:[s.reportCount," reports"]}),e.jsxs("span",{className:"text-sm font-medium text-gray-900",children:["KES ",s.totalFare.toLocaleString()]})]})]},s._id.day))})]})]}),r==="competitive"&&e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:a("saccoDashboard.marketPosition.title")}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-md font-medium text-gray-700 mb-3",children:a("saccoDashboard.yourPerformance")}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:a("saccoDashboard.marketRanking")}),e.jsxs("span",{className:"text-sm font-medium",children:["#",t.competitiveAnalysis.saccoRanking]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("span",{className:"text-sm text-gray-600",children:[a("saccoDashboard.totalReports"),":"]}),e.jsx("span",{className:"text-sm font-medium",children:t.competitiveAnalysis.performanceVsMarket.saccoReports})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:a("saccoDashboard.marketAverage")}),e.jsx("span",{className:"text-sm font-medium",children:t.competitiveAnalysis.performanceVsMarket.marketAvg})]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-md font-medium text-gray-700 mb-3",children:a("saccoDashboard.top5Saccos")}),e.jsx("div",{className:"space-y-2",children:t.competitiveAnalysis.marketPosition.map((s,c)=>e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("span",{className:"text-sm text-gray-600",children:["#",c+1," ",s._id]}),e.jsxs("span",{className:"text-sm font-medium",children:[s.totalReports," reports"]})]},s._id))})]})]})]})}),r==="insights"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:a("saccoDashboard.incidentHotspots")}),e.jsx("div",{className:"space-y-3",children:t.geographicInsights.hotspots.map((s,c)=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(m,{className:"w-4 h-4 text-red-500 mr-2"}),e.jsxs("span",{className:"text-sm text-gray-600",children:[s._id.lat.toFixed(2),", ",s._id.lng.toFixed(2)]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"text-xs text-gray-500",children:s.types.join(", ")}),e.jsx("span",{className:"text-sm font-medium text-gray-900",children:s.count})]})]},c))})]}),e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:a("saccoDashboard.peakHoursAnalysis")}),e.jsx("div",{className:"space-y-3",children:t.timeAnalytics.peakHours.map(s=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(T,{className:"w-4 h-4 text-blue-500 mr-2"}),e.jsxs("span",{className:"text-sm text-gray-600",children:[s.hour,":00 - ",s.hour+1,":00"]})]}),e.jsxs("span",{className:"text-sm font-medium text-gray-900",children:[s.count," reports"]})]},s.hour))})]})]})]})})]})};export{O as default};
//# sourceMappingURL=SaccoDashboard-D4cs-xgB.js.map
