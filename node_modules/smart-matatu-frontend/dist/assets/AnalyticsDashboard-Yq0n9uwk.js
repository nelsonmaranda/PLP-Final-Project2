import{u as K,a as m,j as e}from"./index-Ca5w2wSI.js";import{r as l}from"./vendor-BKU87Gzz.js";import{q as Q,A,R as C,O as V,g as F,T as W,l as k,F as P,y as G,Z as H,Q as J,n as X,V as ee,Y as se,_ as te}from"./icons-B_aqzpWL.js";import"./router-Z6rqMkFf.js";function ne(){var T;const{state:h}=K(),[E,n]=l.useState(!0),[u,r]=l.useState(null),[x,D]=l.useState("efficiency"),[$,p]=l.useState([]),[z,N]=l.useState([]),[y,v]=l.useState([]),[O,b]=l.useState([]),[w,R]=l.useState([]),[j,S]=l.useState(null),[c,U]=l.useState(""),[o,I]=l.useState("08:00"),[g,L]=l.useState("weekly"),d=l.useCallback(async()=>{var s;if(!((s=h.user)!=null&&s._id)){r("User not authenticated."),n(!1);return}n(!0),r(null);try{const t=await m.getUserRecommendations(h.user._id);if(t.success&&t.data?S(t.data):S(null),c){const[a,i,f]=await Promise.all([m.getRouteEfficiency(c),m.analyzeTrends(c,g),m.forecastDemand(c,o)]);p(a.success&&a.data?[a.data]:[]),b(i.success&&i.data?[i.data]:[]),R(f.success&&f.data?[f.data]:[])}else p([]),b([]),R([]);v([]),N([])}catch(t){console.error("Error loading analytics data:",t),r("Failed to load analytics data. Please try again.")}finally{n(!1)}},[(T=h.user)==null?void 0:T._id,c,g,o]);l.useEffect(()=>{d()},[d]);const _=async()=>{try{if(n(!0),r(null),!c)return;const s=await m.predictTravelTime(c,"From","To",o);N(s.success&&s.data?[s.data]:[])}catch(s){console.error(s),r("Failed to predict travel time.")}finally{n(!1)}},M=async()=>{try{n(!0),r(null);const s=await m.findAlternativeRoutes("From","To");v(s.success&&s.data?s.data.alternatives:[])}catch(s){console.error(s),r("Failed to fetch alternative routes.")}finally{n(!1)}},Z=s=>{switch(s){case"increasing":case"improving":case"safer":return e.jsx(te,{className:"w-4 h-4 text-green-500"});case"decreasing":case"declining":case"riskier":return e.jsx(se,{className:"w-4 h-4 text-red-500"});default:return e.jsx(ee,{className:"w-4 h-4 text-gray-500"})}},Y=s=>{switch(s){case"increasing":case"improving":case"safer":return"text-green-600";case"decreasing":case"declining":case"riskier":return"text-red-600";default:return"text-gray-600"}},q=s=>s>=80?"text-green-600":s>=60?"text-yellow-600":"text-red-600",B=s=>s>=80?"bg-green-100":s>=60?"bg-yellow-100":"bg-red-100";return E?e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:e.jsxs("div",{className:"text-center",children:[e.jsx(Q,{className:"h-10 w-10 text-primary-500 animate-spin"}),e.jsx("p",{className:"text-gray-600 mt-4",children:"Loading Advanced Analytics..."})]})}):u?e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:e.jsxs("div",{className:"text-center p-6 bg-white rounded-lg shadow-md",children:[e.jsx(A,{className:"h-12 w-12 text-red-500 mx-auto mb-4"}),e.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-2",children:"Error Loading Analytics"}),e.jsx("p",{className:"text-gray-600 mb-4",children:u}),e.jsxs("button",{onClick:d,className:"btn btn-primary",children:[e.jsx(C,{className:"w-4 h-4 mr-2"}),"Retry"]})]})}):e.jsx("div",{className:"min-h-screen bg-gray-50",children:e.jsxs("div",{className:"px-6 py-8",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Advanced Analytics"}),e.jsx("p",{className:"text-gray-600",children:"Comprehensive insights and predictions for route optimization"})]}),e.jsx("div",{className:"mb-8",children:e.jsx("div",{className:"border-b border-gray-200",children:e.jsx("nav",{className:"-mb-px flex space-x-8",children:[{id:"efficiency",name:"Route Efficiency",icon:V},{id:"predictions",name:"Travel Predictions",icon:F},{id:"trends",name:"Trend Analysis",icon:W},{id:"recommendations",name:"Recommendations",icon:k}].map(s=>{const t=s.icon;return e.jsxs("button",{onClick:()=>D(s.id),className:`flex items-center space-x-2 py-2 px-1 border-b-2 font-medium text-sm ${x===s.id?"border-primary-500 text-primary-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[e.jsx(t,{className:"w-4 h-4"}),e.jsx("span",{children:s.name})]},s.id)})})})}),e.jsxs("div",{className:"space-y-6",children:[x==="efficiency"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Route Efficiency Scores"}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("select",{value:c,onChange:s=>U(s.target.value),className:"form-select",children:e.jsx("option",{value:"",children:"Select a route"})}),e.jsxs("button",{className:"btn btn-outline",onClick:d,children:[e.jsx(P,{className:"w-4 h-4 mr-2"}),"Refresh"]})]})]}),e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:$.map(s=>e.jsxs("div",{className:"card p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:s.routeName}),e.jsxs("div",{className:`px-3 py-1 rounded-full text-sm font-medium ${B(s.efficiencyScore)} ${q(s.efficiencyScore)}`,children:[s.efficiencyScore,"/100"]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"grid grid-cols-2 gap-4",children:Object.entries(s.factors).map(([t,a])=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600 capitalize",children:t}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-16 bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-primary-500 h-2 rounded-full",style:{width:`${a}%`}})}),e.jsx("span",{className:"text-sm font-medium text-gray-900",children:a})]})]},t))}),s.recommendations.length>0&&e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-gray-900 mb-2",children:"Recommendations"}),e.jsx("ul",{className:"space-y-1",children:s.recommendations.map((t,a)=>e.jsxs("li",{className:"flex items-start space-x-2 text-sm text-gray-600",children:[e.jsx(G,{className:"w-4 h-4 text-green-500 mt-0.5 flex-shrink-0"}),e.jsx("span",{children:t})]},a))})]})]})]},s.routeId))})]}),x==="predictions"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Travel Time Predictions"}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("input",{type:"time",value:o,onChange:s=>I(s.target.value),className:"form-input"}),e.jsxs("button",{className:"btn btn-primary",onClick:_,children:[e.jsx(H,{className:"w-4 h-4 mr-2"}),"Predict"]})]})]}),e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:z.map((s,t)=>e.jsxs("div",{className:"card p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900",children:[s.fromStop," â†’ ",s.toStop]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-2xl font-bold text-primary-600",children:[s.predictedTime," min"]}),e.jsxs("div",{className:"text-sm text-gray-500",children:[s.confidence,"% confidence"]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{className:"text-center p-3 bg-green-50 rounded-lg",children:[e.jsxs("div",{className:"text-lg font-semibold text-green-600",children:[s.alternativeTimes.optimistic," min"]}),e.jsx("div",{className:"text-xs text-green-600",children:"Optimistic"})]}),e.jsxs("div",{className:"text-center p-3 bg-blue-50 rounded-lg",children:[e.jsxs("div",{className:"text-lg font-semibold text-blue-600",children:[s.alternativeTimes.realistic," min"]}),e.jsx("div",{className:"text-xs text-blue-600",children:"Realistic"})]}),e.jsxs("div",{className:"text-center p-3 bg-red-50 rounded-lg",children:[e.jsxs("div",{className:"text-lg font-semibold text-red-600",children:[s.alternativeTimes.pessimistic," min"]}),e.jsx("div",{className:"text-xs text-red-600",children:"Pessimistic"})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-gray-900 mb-2",children:"Factors"}),e.jsx("div",{className:"grid grid-cols-2 gap-2 text-sm",children:Object.entries(s.factors).map(([a,i])=>e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600 capitalize",children:a.replace(/([A-Z])/g," $1")}),e.jsxs("span",{className:"font-medium",children:[i.toFixed(2),"x"]})]},a))})]})]})]},t))}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-xl font-semibold text-gray-900",children:"Alternative Routes"}),e.jsxs("button",{className:"btn btn-outline",onClick:M,children:[e.jsx(P,{className:"w-4 h-4 mr-2"}),"Find"]})]}),y.length>0&&e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:y.map((s,t)=>e.jsxs("div",{className:"card p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h4",{className:"font-semibold text-gray-900",children:s.routeName}),e.jsxs("div",{className:"text-sm text-gray-500",children:[s.efficiency,"/100"]})]}),e.jsxs("div",{className:"flex items-center space-x-4 text-sm text-gray-600",children:[e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(F,{className:"w-4 h-4"}),e.jsxs("span",{children:[s.totalTime," min"]})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(J,{className:"w-4 h-4"}),e.jsxs("span",{children:["Ksh ",s.totalCost]})]})]}),e.jsx("div",{className:"mt-2",children:e.jsxs("div",{className:"text-xs text-gray-500",children:["Reasons: ",s.reasons.join(", ")]})})]},t))})]})]}),x==="trends"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Trend Analysis"}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("select",{value:g,onChange:s=>L(s.target.value),className:"form-select",children:[e.jsx("option",{value:"daily",children:"Daily"}),e.jsx("option",{value:"weekly",children:"Weekly"}),e.jsx("option",{value:"monthly",children:"Monthly"})]}),e.jsxs("button",{className:"btn btn-outline",onClick:d,children:[e.jsx(X,{className:"w-4 h-4 mr-2"}),"Update"]})]})]}),e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:O.map((s,t)=>e.jsxs("div",{className:"card p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:["Route Trends (",s.period,")"]}),e.jsx("div",{className:"space-y-4",children:Object.entries(s.trends).map(([a,i])=>e.jsxs("div",{className:"border rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"font-medium text-gray-900 capitalize",children:a}),e.jsxs("div",{className:"flex items-center space-x-2",children:[Z(i.trend),e.jsxs("span",{className:`text-sm font-medium ${Y(i.trend)}`,children:[i.change>0?"+":"",i.change.toFixed(1),"%"]})]})]}),e.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-600",children:[e.jsxs("span",{children:["Current: ",i.current]}),e.jsxs("span",{children:["Previous: ",i.previous]})]})]},a))}),s.insights.length>0&&e.jsxs("div",{className:"mt-4",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-900 mb-2",children:"Insights"}),e.jsx("ul",{className:"space-y-1",children:s.insights.map((a,i)=>e.jsxs("li",{className:"flex items-start space-x-2 text-sm text-gray-600",children:[e.jsx(A,{className:"w-4 h-4 text-blue-500 mt-0.5 flex-shrink-0"}),e.jsx("span",{children:a})]},i))})]})]},t))})]}),x==="recommendations"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Personalized Recommendations"}),e.jsxs("button",{className:"btn btn-primary",onClick:d,children:[e.jsx(C,{className:"w-4 h-4 mr-2"}),"Refresh"]})]}),j&&e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"card p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Your Preferences"}),e.jsx("div",{className:"space-y-3",children:Object.entries(j.preferences).map(([s,t])=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600 capitalize",children:s}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-20 bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-primary-500 h-2 rounded-full",style:{width:`${t*100}%`}})}),e.jsxs("span",{className:"text-sm font-medium text-gray-900",children:[Math.round(t*100),"%"]})]})]},s))})]}),e.jsxs("div",{className:"card p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Recommended Routes"}),e.jsx("div",{className:"space-y-3",children:j.recommendations.map((s,t)=>e.jsxs("div",{className:"border rounded-lg p-4 hover:bg-gray-50",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h4",{className:"font-medium text-gray-900",children:s.routeName}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(k,{className:"w-4 h-4 text-yellow-500"}),e.jsxs("span",{className:"text-sm font-medium text-gray-900",children:[s.score,"/100"]})]})]}),e.jsx("p",{className:"text-sm text-gray-600 mb-2",children:s.reason}),e.jsx("div",{className:"flex items-center space-x-2",children:e.jsx("span",{className:`px-2 py-1 text-xs rounded-full ${s.type==="efficiency"?"bg-blue-100 text-blue-800":s.type==="safety"?"bg-green-100 text-green-800":s.type==="cost"?"bg-yellow-100 text-yellow-800":"bg-purple-100 text-purple-800"}`,children:s.type})})]},t))})]})]}),w.length>0&&e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Demand Forecasts"}),e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:w.map((s,t)=>e.jsxs("div",{className:"card p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("h4",{className:"font-semibold text-gray-900",children:["Time Slot: ",s.timeSlot]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-lg font-bold text-primary-600",children:[s.predictedDemand,"%"]}),e.jsxs("div",{className:"text-sm text-gray-500",children:[s.confidence,"% confidence"]})]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2 mb-2",children:e.jsx("div",{className:"bg-primary-500 h-2 rounded-full",style:{width:`${s.predictedDemand}%`}})}),s.recommendations.length>0&&e.jsx("div",{className:"text-sm text-gray-600",children:s.recommendations[0]})]},t))})]})]})]})]})})}export{ne as default};
//# sourceMappingURL=AnalyticsDashboard-Yq0n9uwk.js.map
