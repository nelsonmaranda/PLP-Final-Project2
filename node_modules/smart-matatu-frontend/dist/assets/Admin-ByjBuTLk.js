import{j as e,a as l}from"./index-C7slk2iE.js";import{r as x}from"./vendor-BKU87Gzz.js";import{M as f,B as v,c as b,A as w,I as R,E as A,J as C,K as k}from"./icons-B_aqzpWL.js";import"./router-Z6rqMkFf.js";function _(){const[h,a]=x.useState(!0),[r,c]=x.useState([]),[p,m]=x.useState(!1),[n,u]=x.useState({name:"",description:""});x.useEffect(()=>{(async()=>{try{a(!0);const t=await l.getRoutes({page:1,limit:100,sort:"createdAt",order:"desc"});t.success&&t.data?c(t.data.routes):c([])}catch(t){console.error("Failed to load routes",t),c([])}finally{a(!1)}})()},[]);const g=async()=>{try{if(n.name.trim()){a(!0);const s=await l.createRoute({name:n.name,description:n.description});if(s.success&&s.data){const t=await l.getRoutes({page:1,limit:100,sort:"createdAt",order:"desc"});c(t.success&&t.data?t.data.routes:[]),u({name:"",description:""}),m(!1)}}}catch(s){console.error("Failed to add route",s)}finally{a(!1)}},j=async s=>{try{a(!0),await l.deleteRoute(s);const t=await l.getRoutes({page:1,limit:100,sort:"createdAt",order:"desc"});c(t.success&&t.data?t.data.routes:[])}catch(t){console.error("Failed to delete route",t)}finally{a(!1)}},y=async s=>{try{a(!0);const t=r.find(o=>o._id===s||o.id===s);if(!t)return;const i=t.status==="active"?"inactive":"active";await l.updateRoute(t._id||t.id,{status:i});const d=await l.getRoutes({page:1,limit:100,sort:"createdAt",order:"desc"});c(d.success&&d.data?d.data.routes:[])}catch(t){console.error("Failed to toggle route status",t)}finally{a(!1)}},N=[{title:"Total Routes",value:r.length,icon:f,color:"text-blue-600",bgColor:"bg-blue-100"},{title:"Active Routes",value:r.filter(s=>s.status==="active").length,icon:v,color:"text-green-600",bgColor:"bg-green-100"},{title:"Total Reports",value:r.reduce((s,t)=>s+(t.reports||0),0),icon:b,color:"text-purple-600",bgColor:"bg-purple-100"},{title:"Safety Issues",value:r.reduce((s,t)=>s+(t.safetyIssues||0),0),icon:w,color:"text-red-600",bgColor:"bg-red-100"}];return h?e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"loading-spinner mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Loading admin dashboard..."})]})}):e.jsx("div",{className:"min-h-screen bg-gray-50",children:e.jsxs("div",{className:"container py-6",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Admin Dashboard"}),e.jsx("p",{className:"text-gray-600 mt-2",children:"Manage routes, reports, and system settings"})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:N.map((s,t)=>{const i=s.icon;return e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-content",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:`p-3 rounded-lg ${s.bgColor}`,children:e.jsx(i,{className:`w-6 h-6 ${s.color}`})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:s.title}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:s.value})]})]})})},t)})}),e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h2",{className:"card-title",children:"Route Management"}),e.jsxs("button",{onClick:()=>m(!0),className:"btn btn-primary btn-sm",children:[e.jsx(R,{className:"w-4 h-4 mr-2"}),"Add Route"]})]})}),e.jsxs("div",{className:"card-content p-0",children:[p&&e.jsxs("div",{className:"border-b border-gray-200 p-6 bg-gray-50",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Add New Route"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Route Name"}),e.jsx("input",{type:"text",value:n.name,onChange:s=>u(t=>({...t,name:s.target.value})),className:"form-input",placeholder:"e.g., Route 42 - Thika Road"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Description"}),e.jsx("input",{type:"text",value:n.description,onChange:s=>u(t=>({...t,description:s.target.value})),className:"form-input",placeholder:"Route description"})]})]}),e.jsxs("div",{className:"flex justify-end space-x-3 mt-4",children:[e.jsx("button",{onClick:()=>m(!1),className:"btn btn-outline",children:"Cancel"}),e.jsx("button",{onClick:g,className:"btn btn-primary",children:"Add Route"})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Route"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Reliability"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Safety"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Reports"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:r.map(s=>{var t,i,d,o;return e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"text-sm font-medium text-gray-900",children:s.name})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"text-sm text-gray-900",children:((t=s.score)==null?void 0:t.reliability)??"-"}),e.jsx("div",{className:"ml-2 w-16 bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-blue-600 h-2 rounded-full",style:{width:`${(((i=s.score)==null?void 0:i.reliability)??0)/5*100}%`}})})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"text-sm text-gray-900",children:((d=s.score)==null?void 0:d.safety)??"-"}),e.jsx("div",{className:"ml-2 w-16 bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-green-600 h-2 rounded-full",style:{width:`${(((o=s.score)==null?void 0:o.safety)??0)/5*100}%`}})})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:s.reportsCount??0}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${s.status==="active"?"bg-green-100 text-green-800":s.status==="maintenance"?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:s.status||"active"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{className:"text-blue-600 hover:text-blue-900",children:e.jsx(A,{className:"w-4 h-4"})}),e.jsx("button",{className:"text-gray-600 hover:text-gray-900",children:e.jsx(C,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>y(s._id||s.id),className:"text-green-600 hover:text-green-900",children:(s.status||"active")==="active"?"Deactivate":"Activate"}),e.jsx("button",{onClick:()=>j(s._id||s.id),className:"text-red-600 hover:text-red-900",children:e.jsx(k,{className:"w-4 h-4"})})]})})]},s._id||s.id)})})]})})]})]})]})})}export{_ as default};
//# sourceMappingURL=Admin-ByjBuTLk.js.map
