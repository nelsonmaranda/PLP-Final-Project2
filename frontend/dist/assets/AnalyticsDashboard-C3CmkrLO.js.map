{"version":3,"file":"AnalyticsDashboard-C3CmkrLO.js","sources":["../../src/screens/AnalyticsDashboard.tsx"],"sourcesContent":["import { useState, useEffect, useCallback } from 'react'\r\nimport { \r\n  TrendingUp, \r\n  Clock, \r\n  Target, \r\n  AlertTriangle,\r\n  CheckCircle,\r\n  ArrowUp,\r\n  ArrowDown,\r\n  Minus,\r\n  Loader2,\r\n  RefreshCw,\r\n  Filter,\r\n  Calendar,\r\n  Zap,\r\n  DollarSign,\r\n  Star\r\n} from 'lucide-react'\r\nimport { useApp } from '../contexts/AppContext'\r\nimport apiService from '../services/api'\r\nimport { \r\n  RouteEfficiencyScore, \r\n  TravelTimePrediction, \r\n  AlternativeRoute, \r\n  TrendAnalysis, \r\n  DemandForecast, \r\n  UserRecommendation \r\n} from '../types'\r\n\r\ninterface SimpleRoute {\r\n  _id: string\r\n  name: string\r\n  routeNumber?: string\r\n  stops?: { name: string; coordinates: [number, number] }[]\r\n}\r\n\r\nexport default function AnalyticsDashboard() {\r\n  const { state } = useApp()\r\n  const [isLoading, setIsLoading] = useState(true)\r\n  const [error, setError] = useState<string | null>(null)\r\n  const [activeTab, setActiveTab] = useState<'efficiency' | 'predictions' | 'trends' | 'recommendations'>('efficiency')\r\n  \r\n  // Data states\r\n  const [efficiencyScores, setEfficiencyScores] = useState<RouteEfficiencyScore[]>([])\r\n  const [travelPredictions, setTravelPredictions] = useState<TravelTimePrediction[]>([])\r\n  const [alternativeRoutes, setAlternativeRoutes] = useState<AlternativeRoute[]>([])\r\n  const [trendAnalysis, setTrendAnalysis] = useState<TrendAnalysis[]>([])\r\n  const [demandForecasts, setDemandForecasts] = useState<DemandForecast[]>([])\r\n  const [userRecommendations, setUserRecommendations] = useState<UserRecommendation | null>(null)\r\n\r\n  // Route and filter states\r\n  const [routes, setRoutes] = useState<SimpleRoute[]>([])\r\n  const [selectedRoute, setSelectedRoute] = useState<string>('')\r\n  const [availableStops, setAvailableStops] = useState<string[]>([])\r\n  const [fromStop, setFromStop] = useState<string>('')\r\n  const [toStop, setToStop] = useState<string>('')\r\n  const [timeSlot, setTimeSlot] = useState<string>('08:00')\r\n  const [period, setPeriod] = useState<'daily' | 'weekly' | 'monthly'>('weekly')\r\n\r\n  // Load list of routes once\r\n  useEffect(() => {\r\n    const loadRoutes = async () => {\r\n      try {\r\n        const res = await apiService.getRoutes({ page: 1, limit: 200, sort: 'name', order: 'asc' })\r\n        if (res.success && res.data && res.data.routes) {\r\n          const simple: SimpleRoute[] = (res.data.routes as any[]).map(r => ({\r\n            _id: r._id,\r\n            name: r.name,\r\n            routeNumber: r.routeNumber,\r\n            stops: r.stops\r\n          }))\r\n          setRoutes(simple)\r\n        } else {\r\n          setRoutes([])\r\n        }\r\n      } catch (e) {\r\n        console.error('Failed to load routes for analytics', e)\r\n        setRoutes([])\r\n      }\r\n    }\r\n    loadRoutes()\r\n  }, [])\r\n\r\n  // When route changes, derive stops\r\n  useEffect(() => {\r\n    const r = routes.find(rt => rt._id === selectedRoute)\r\n    const stops = r?.stops?.map(s => s.name) || []\r\n    setAvailableStops(stops)\r\n    // reset selections that may be invalid\r\n    setFromStop(prev => (stops.includes(prev) ? prev : ''))\r\n    setToStop(prev => (stops.includes(prev) ? prev : ''))\r\n  }, [selectedRoute, routes])\r\n\r\n  const loadAnalyticsData = useCallback(async () => {\r\n    if (!state.user?._id) {\r\n      setError('User not authenticated.')\r\n      setIsLoading(false)\r\n      return\r\n    }\r\n\r\n    setIsLoading(true)\r\n    setError(null)\r\n\r\n    try {\r\n      // Fetch recommendations\r\n      const recommendationsResponse = await apiService.getUserRecommendations(state.user._id)\r\n      if (recommendationsResponse.success && recommendationsResponse.data) {\r\n        setUserRecommendations(recommendationsResponse.data)\r\n      } else {\r\n        setUserRecommendations(null)\r\n      }\r\n\r\n      // If a route is selected, load per-route analytics; otherwise, clear\r\n      if (selectedRoute) {\r\n        const [effResp, trendsResp, demandResp] = await Promise.all([\r\n          apiService.getRouteEfficiency(selectedRoute),\r\n          apiService.analyzeTrends(selectedRoute, period),\r\n          apiService.forecastDemand(selectedRoute, timeSlot)\r\n        ])\r\n\r\n        setEfficiencyScores(effResp.success && effResp.data ? [effResp.data] : [])\r\n        setTrendAnalysis(trendsResp.success && trendsResp.data ? [trendsResp.data] : [])\r\n        setDemandForecasts(demandResp.success && demandResp.data ? [demandResp.data] : [])\r\n      } else {\r\n        setEfficiencyScores([])\r\n        setTrendAnalysis([])\r\n        setDemandForecasts([])\r\n      }\r\n\r\n      // Alternative routes and travel predictions are user-triggered\r\n      setAlternativeRoutes([])\r\n      setTravelPredictions([])\r\n\r\n    } catch (error) {\r\n      console.error('Error loading analytics data:', error)\r\n      setError('Failed to load analytics data. Please try again.')\r\n    } finally {\r\n      setIsLoading(false)\r\n    }\r\n  }, [state.user?._id, selectedRoute, period, timeSlot])\r\n\r\n  useEffect(() => {\r\n    loadAnalyticsData()\r\n  }, [loadAnalyticsData])\r\n\r\n  const handlePredictTravel = async () => {\r\n    try {\r\n      if (!selectedRoute || !fromStop || !toStop) {\r\n        setError('Please select a route, From stop, and To stop.')\r\n        return\r\n      }\r\n      setIsLoading(true)\r\n      setError(null)\r\n      const resp = await apiService.predictTravelTime(selectedRoute, fromStop, toStop, timeSlot)\r\n      setTravelPredictions(resp.success && resp.data ? [resp.data] : [])\r\n    } catch (e) {\r\n      console.error(e)\r\n      setError('Failed to predict travel time.')\r\n    } finally {\r\n      setIsLoading(false)\r\n    }\r\n  }\r\n\r\n  const handleFindAlternatives = async () => {\r\n    try {\r\n      if (!fromStop || !toStop) {\r\n        setError('Please select From and To stops to find alternatives.')\r\n        return\r\n      }\r\n      setIsLoading(true)\r\n      setError(null)\r\n      const resp = await apiService.findAlternativeRoutes(fromStop, toStop)\r\n      setAlternativeRoutes(resp.success && resp.data ? resp.data.alternatives : [])\r\n    } catch (e) {\r\n      console.error(e)\r\n      setError('Failed to fetch alternative routes.')\r\n    } finally {\r\n      setIsLoading(false)\r\n    }\r\n  }\r\n\r\n  const getTrendIcon = (trend: 'increasing' | 'decreasing' | 'stable' | 'improving' | 'declining' | 'safer' | 'riskier') => {\r\n    switch (trend) {\r\n      case 'increasing':\r\n      case 'improving':\r\n      case 'safer':\r\n        return <ArrowUp className=\"w-4 h-4 text-green-500\" />\r\n      case 'decreasing':\r\n      case 'declining':\r\n      case 'riskier':\r\n        return <ArrowDown className=\"w-4 h-4 text-red-500\" />\r\n      default:\r\n        return <Minus className=\"w-4 h-4 text-gray-500\" />\r\n    }\r\n  }\r\n\r\n  const getTrendColor = (trend: 'increasing' | 'decreasing' | 'stable' | 'improving' | 'declining' | 'safer' | 'riskier') => {\r\n    switch (trend) {\r\n      case 'increasing':\r\n      case 'improving':\r\n      case 'safer':\r\n        return 'text-green-600'\r\n      case 'decreasing':\r\n      case 'declining':\r\n      case 'riskier':\r\n        return 'text-red-600'\r\n      default:\r\n        return 'text-gray-600'\r\n    }\r\n  }\r\n\r\n  const getEfficiencyColor = (score: number) => {\r\n    if (score >= 80) return 'text-green-600'\r\n    if (score >= 60) return 'text-yellow-600'\r\n    return 'text-red-600'\r\n  }\r\n\r\n  const getEfficiencyBgColor = (score: number) => {\r\n    if (score >= 80) return 'bg-green-100'\r\n    if (score >= 60) return 'bg-yellow-100'\r\n    return 'bg-red-100'\r\n  }\r\n\r\n  if (isLoading) {\r\n    return (\r\n      <div className=\"min-h-screen flex items-center justify-center bg-gray-50\">\r\n        <div className=\"text-center\">\r\n          <Loader2 className=\"h-10 w-10 text-primary-500 animate-spin\" />\r\n          <p className=\"text-gray-600 mt-4\">Loading Advanced Analytics...</p>\r\n        </div>\r\n      </div>\r\n    )\r\n  }\r\n\r\n  if (error) {\r\n    return (\r\n      <div className=\"min-h-screen flex items-center justify-center bg-gray-50\">\r\n        <div className=\"text-center p-6 bg-white rounded-lg shadow-md\">\r\n          <AlertTriangle className=\"h-12 w-12 text-red-500 mx-auto mb-4\" />\r\n          <h2 className=\"text-xl font-semibold text-gray-800 mb-2\">Error Loading Analytics</h2>\r\n          <p className=\"text-gray-600 mb-4\">{error}</p>\r\n          <button \r\n            onClick={loadAnalyticsData} \r\n            className=\"btn btn-primary\"\r\n          >\r\n            <RefreshCw className=\"w-4 h-4 mr-2\" />\r\n            Retry\r\n          </button>\r\n        </div>\r\n      </div>\r\n    )\r\n  }\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-gray-50\">\r\n      <div className=\"px-6 py-8\">\r\n        {/* Header */}\r\n        <div className=\"mb-8\">\r\n          <h1 className=\"text-3xl font-bold text-gray-900 mb-2\">Advanced Analytics</h1>\r\n          <p className=\"text-gray-600\">Comprehensive insights and predictions for route optimization</p>\r\n        </div>\r\n\r\n        {/* Tab Navigation */}\r\n        <div className=\"mb-8\">\r\n          <div className=\"border-b border-gray-200\">\r\n            <nav className=\"-mb-px flex space-x-8\">\r\n              {[\r\n                { id: 'efficiency', name: 'Route Efficiency', icon: Target },\r\n                { id: 'predictions', name: 'Travel Predictions', icon: Clock },\r\n                { id: 'trends', name: 'Trend Analysis', icon: TrendingUp },\r\n                { id: 'recommendations', name: 'Recommendations', icon: Star }\r\n              ].map((tab) => {\r\n                const Icon = tab.icon\r\n                return (\r\n                  <button\r\n                    key={tab.id}\r\n                    onClick={() => setActiveTab(tab.id as any)}\r\n                    className={`flex items-center space-x-2 py-2 px-1 border-b-2 font-medium text-sm ${\r\n                      activeTab === tab.id\r\n                        ? 'border-primary-500 text-primary-600'\r\n                        : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300'\r\n                    }`}\r\n                  >\r\n                    <Icon className=\"w-4 h-4\" />\r\n                    <span>{tab.name}</span>\r\n                  </button>\r\n                )\r\n              })}\r\n            </nav>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Tab Content */}\r\n        <div className=\"space-y-6\">\r\n          {/* Route Efficiency Tab */}\r\n          {activeTab === 'efficiency' && (\r\n            <div className=\"space-y-6\">\r\n              <div className=\"flex items-center justify-between\">\r\n                <h2 className=\"text-2xl font-bold text-gray-900\">Route Efficiency Scores</h2>\r\n                <div className=\"flex items-center space-x-4\">\r\n                  <select\r\n                    value={selectedRoute}\r\n                    onChange={(e) => setSelectedRoute(e.target.value)}\r\n                    className=\"form-select\"\r\n                  >\r\n                    <option value=\"\">Select a route</option>\r\n                    {routes.map(r => (\r\n                      <option key={r._id} value={r._id}>\r\n                        {r.routeNumber ? `${r.routeNumber} - ${r.name}` : r.name}\r\n                      </option>\r\n                    ))}\r\n                  </select>\r\n                  <button className=\"btn btn-outline\" onClick={loadAnalyticsData} disabled={!selectedRoute}>\r\n                    <Filter className=\"w-4 h-4 mr-2\" />\r\n                    Refresh\r\n                  </button>\r\n                </div>\r\n              </div>\r\n\r\n              <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6\">\r\n                {efficiencyScores.map((score) => (\r\n                  <div key={score.routeId} className=\"card p-6\">\r\n                    <div className=\"flex items-center justify-between mb-4\">\r\n                      <h3 className=\"text-lg font-semibold text-gray-900\">{score.routeName}</h3>\r\n                      <div className={`px-3 py-1 rounded-full text-sm font-medium ${getEfficiencyBgColor(score.efficiencyScore)} ${getEfficiencyColor(score.efficiencyScore)}`}>\r\n                        {score.efficiencyScore}/100\r\n                      </div>\r\n                    </div>\r\n\r\n                    <div className=\"space-y-4\">\r\n                      {/* Efficiency Factors */}\r\n                      <div className=\"grid grid-cols-2 gap-4\">\r\n                        {Object.entries(score.factors).map(([key, value]) => (\r\n                          <div key={key} className=\"flex items-center justify-between\">\r\n                            <span className=\"text-sm text-gray-600 capitalize\">{key}</span>\r\n                            <div className=\"flex items-center space-x-2\">\r\n                              <div className=\"w-16 bg-gray-200 rounded-full h-2\">\r\n                                <div \r\n                                  className=\"bg-primary-500 h-2 rounded-full\" \r\n                                  style={{ width: `${value}%` }}\r\n                                ></div>\r\n                              </div>\r\n                              <span className=\"text-sm font-medium text-gray-900\">{value}</span>\r\n                            </div>\r\n                          </div>\r\n                        ))}\r\n                      </div>\r\n\r\n                      {/* Recommendations */}\r\n                      {score.recommendations.length > 0 && (\r\n                        <div>\r\n                          <h4 className=\"text-sm font-medium text-gray-900 mb-2\">Recommendations</h4>\r\n                          <ul className=\"space-y-1\">\r\n                            {score.recommendations.map((rec, index) => (\r\n                              <li key={index} className=\"flex items-start space-x-2 text-sm text-gray-600\">\r\n                                <CheckCircle className=\"w-4 h-4 text-green-500 mt-0.5 flex-shrink-0\" />\r\n                                <span>{rec}</span>\r\n                              </li>\r\n                            ))}\r\n                          </ul>\r\n                        </div>\r\n                      )}\r\n                    </div>\r\n                  </div>\r\n                ))}\r\n              </div>\r\n            </div>\r\n          )}\r\n\r\n          {/* Travel Predictions Tab */}\r\n          {activeTab === 'predictions' && (\r\n            <div className=\"space-y-6\">\r\n              <div className=\"flex items-center justify-between\">\r\n                <h2 className=\"text-2xl font-bold text-gray-900\">Travel Time Predictions</h2>\r\n                <div className=\"flex items-center space-x-4\">\r\n                  <select\r\n                    value={selectedRoute}\r\n                    onChange={(e) => setSelectedRoute(e.target.value)}\r\n                    className=\"form-select\"\r\n                  >\r\n                    <option value=\"\">Select route</option>\r\n                    {routes.map(r => (\r\n                      <option key={r._id} value={r._id}>\r\n                        {r.routeNumber ? `${r.routeNumber} - ${r.name}` : r.name}\r\n                      </option>\r\n                    ))}\r\n                  </select>\r\n                  <select\r\n                    value={fromStop}\r\n                    onChange={(e) => setFromStop(e.target.value)}\r\n                    className=\"form-select\"\r\n                    disabled={!selectedRoute}\r\n                  >\r\n                    <option value=\"\">From stop</option>\r\n                    {availableStops.map(s => (\r\n                      <option key={s} value={s}>{s}</option>\r\n                    ))}\r\n                  </select>\r\n                  <select\r\n                    value={toStop}\r\n                    onChange={(e) => setToStop(e.target.value)}\r\n                    className=\"form-select\"\r\n                    disabled={!selectedRoute}\r\n                  >\r\n                    <option value=\"\">To stop</option>\r\n                    {availableStops.map(s => (\r\n                      <option key={s} value={s}>{s}</option>\r\n                    ))}\r\n                  </select>\r\n                  <input\r\n                    type=\"time\"\r\n                    value={timeSlot}\r\n                    onChange={(e) => setTimeSlot(e.target.value)}\r\n                    className=\"form-input\"\r\n                  />\r\n                  <button className=\"btn btn-primary\" onClick={handlePredictTravel} disabled={!selectedRoute || !fromStop || !toStop}>\r\n                    <Zap className=\"w-4 h-4 mr-2\" />\r\n                    Predict\r\n                  </button>\r\n                </div>\r\n              </div>\r\n\r\n              <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6\">\r\n                {travelPredictions.map((prediction, index) => (\r\n                  <div key={index} className=\"card p-6\">\r\n                    <div className=\"flex items-center justify-between mb-4\">\r\n                      <h3 className=\"text-lg font-semibold text-gray-900\">\r\n                        {prediction.fromStop} → {prediction.toStop}\r\n                      </h3>\r\n                      <div className=\"text-right\">\r\n                        <div className=\"text-2xl font-bold text-primary-600\">{prediction.predictedTime} min</div>\r\n                        <div className=\"text-sm text-gray-500\">{prediction.confidence}% confidence</div>\r\n                      </div>\r\n                    </div>\r\n\r\n                    <div className=\"space-y-4\">\r\n                      {/* Alternative Times */}\r\n                      <div className=\"grid grid-cols-3 gap-4\">\r\n                        <div className=\"text-center p-3 bg-green-50 rounded-lg\">\r\n                          <div className=\"text-lg font-semibold text-green-600\">{prediction.alternativeTimes.optimistic} min</div>\r\n                          <div className=\"text-xs text-green-600\">Optimistic</div>\r\n                        </div>\r\n                        <div className=\"text-center p-3 bg-blue-50 rounded-lg\">\r\n                          <div className=\"text-lg font-semibold text-blue-600\">{prediction.alternativeTimes.realistic} min</div>\r\n                          <div className=\"text-xs text-blue-600\">Realistic</div>\r\n                        </div>\r\n                        <div className=\"text-center p-3 bg-red-50 rounded-lg\">\r\n                          <div className=\"text-lg font-semibold text-red-600\">{prediction.alternativeTimes.pessimistic} min</div>\r\n                          <div className=\"text-xs text-red-600\">Pessimistic</div>\r\n                        </div>\r\n                      </div>\r\n\r\n                      {/* Factors */}\r\n                      <div>\r\n                        <h4 className=\"text-sm font-medium text-gray-900 mb-2\">Factors</h4>\r\n                        <div className=\"grid grid-cols-2 gap-2 text-sm\">\r\n                          {Object.entries(prediction.factors).map(([key, value]) => (\r\n                            <div key={key} className=\"flex justify-between\">\r\n                              <span className=\"text-gray-600 capitalize\">{key.replace(/([A-Z])/g, ' $1')}</span>\r\n                              <span className=\"font-medium\">{value.toFixed(2)}x</span>\r\n                            </div>\r\n                          ))}\r\n                        </div>\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                ))}\r\n              </div>\r\n\r\n              {/* Alternative Routes */}\r\n              <div>\r\n                <div className=\"flex items-center justify-between mb-4\">\r\n                  <h3 className=\"text-xl font-semibold text-gray-900\">Alternative Routes</h3>\r\n                  <div className=\"flex items-center space-x-3\">\r\n                    <select\r\n                      value={fromStop}\r\n                      onChange={(e) => setFromStop(e.target.value)}\r\n                      className=\"form-select\"\r\n                      disabled={!selectedRoute}\r\n                    >\r\n                      <option value=\"\">From stop</option>\r\n                      {availableStops.map(s => (\r\n                        <option key={s} value={s}>{s}</option>\r\n                      ))}\r\n                    </select>\r\n                    <select\r\n                      value={toStop}\r\n                      onChange={(e) => setToStop(e.target.value)}\r\n                      className=\"form-select\"\r\n                      disabled={!selectedRoute}\r\n                    >\r\n                      <option value=\"\">To stop</option>\r\n                      {availableStops.map(s => (\r\n                        <option key={s} value={s}>{s}</option>\r\n                      ))}\r\n                    </select>\r\n                    <button className=\"btn btn-outline\" onClick={handleFindAlternatives} disabled={!fromStop || !toStop}>\r\n                      <Filter className=\"w-4 h-4 mr-2\" />\r\n                      Find\r\n                    </button>\r\n                  </div>\r\n                </div>\r\n                {alternativeRoutes.length > 0 && (\r\n                  <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-4\">\r\n                    {alternativeRoutes.map((route, index) => (\r\n                      <div key={index} className=\"card p-4\">\r\n                        <div className=\"flex items-center justify-between mb-2\">\r\n                          <h4 className=\"font-semibold text-gray-900\">{route.routeName}</h4>\r\n                          <div className=\"text-sm text-gray-500\">{route.efficiency}/100</div>\r\n                        </div>\r\n                        <div className=\"flex items-center space-x-4 text-sm text-gray-600\">\r\n                          <div className=\"flex items-center space-x-1\">\r\n                            <Clock className=\"w-4 h-4\" />\r\n                            <span>{route.totalTime} min</span>\r\n                          </div>\r\n                          <div className=\"flex items-center space-x-1\">\r\n                            <DollarSign className=\"w-4 h-4\" />\r\n                            <span>Ksh {route.totalCost}</span>\r\n                          </div>\r\n                        </div>\r\n                        <div className=\"mt-2\">\r\n                          <div className=\"text-xs text-gray-500\">Reasons: {route.reasons.join(', ')}</div>\r\n                        </div>\r\n                      </div>\r\n                    ))}\r\n                  </div>\r\n                )}\r\n              </div>\r\n            </div>\r\n          )}\r\n\r\n          {/* Trend Analysis Tab */}\r\n          {activeTab === 'trends' && (\r\n            <div className=\"space-y-6\">\r\n              <div className=\"flex items-center justify-between\">\r\n                <h2 className=\"text-2xl font-bold text-gray-900\">Trend Analysis</h2>\r\n                <div className=\"flex items-center space-x-4\">\r\n                  <select\r\n                    value={selectedRoute}\r\n                    onChange={(e) => setSelectedRoute(e.target.value)}\r\n                    className=\"form-select\"\r\n                  >\r\n                    <option value=\"\">Select route</option>\r\n                    {routes.map(r => (\r\n                      <option key={r._id} value={r._id}>\r\n                        {r.routeNumber ? `${r.routeNumber} - ${r.name}` : r.name}\r\n                      </option>\r\n                    ))}\r\n                  </select>\r\n                  <select\r\n                    value={period}\r\n                    onChange={(e) => setPeriod(e.target.value as any)}\r\n                    className=\"form-select\"\r\n                  >\r\n                    <option value=\"daily\">Daily</option>\r\n                    <option value=\"weekly\">Weekly</option>\r\n                    <option value=\"monthly\">Monthly</option>\r\n                  </select>\r\n                  <button className=\"btn btn-outline\" onClick={loadAnalyticsData} disabled={!selectedRoute}>\r\n                    <Calendar className=\"w-4 h-4 mr-2\" />\r\n                    Update\r\n                  </button>\r\n                </div>\r\n              </div>\r\n\r\n              <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6\">\r\n                {trendAnalysis.map((trend, index) => (\r\n                  <div key={index} className=\"card p-6\">\r\n                    <h3 className=\"text-lg font-semibold text-gray-900 mb-4\">Route Trends ({trend.period})</h3>\r\n                    \r\n                    <div className=\"space-y-4\">\r\n                      {Object.entries(trend.trends).map(([key, data]) => (\r\n                        <div key={key} className=\"border rounded-lg p-4\">\r\n                          <div className=\"flex items-center justify-between mb-2\">\r\n                            <span className=\"font-medium text-gray-900 capitalize\">{key}</span>\r\n                            <div className=\"flex items-center space-x-2\">\r\n                              {getTrendIcon(data.trend)}\r\n                              <span className={`text-sm font-medium ${getTrendColor(data.trend)}`}>\r\n                                {data.change > 0 ? '+' : ''}{data.change.toFixed(1)}%\r\n                              </span>\r\n                            </div>\r\n                          </div>\r\n                          <div className=\"flex items-center justify-between text-sm text-gray-600\">\r\n                            <span>Current: {data.current}</span>\r\n                            <span>Previous: {data.previous}</span>\r\n                          </div>\r\n                        </div>\r\n                      ))}\r\n                    </div>\r\n\r\n                    {trend.insights.length > 0 && (\r\n                      <div className=\"mt-4\">\r\n                        <h4 className=\"text-sm font-medium text-gray-900 mb-2\">Insights</h4>\r\n                        <ul className=\"space-y-1\">\r\n                          {trend.insights.map((insight, idx) => (\r\n                            <li key={idx} className=\"flex items-start space-x-2 text-sm text-gray-600\">\r\n                              <AlertTriangle className=\"w-4 h-4 text-blue-500 mt-0.5 flex-shrink-0\" />\r\n                              <span>{insight}</span>\r\n                            </li>\r\n                          ))}\r\n                        </ul>\r\n                      </div>\r\n                    )}\r\n                  </div>\r\n                ))}\r\n              </div>\r\n            </div>\r\n          )}\r\n\r\n          {/* Recommendations Tab */}\r\n          {activeTab === 'recommendations' && (\r\n            <div className=\"space-y-6\">\r\n              <div className=\"flex items-center justify-between\">\r\n                <h2 className=\"text-2xl font-bold text-gray-900\">Personalized Recommendations</h2>\r\n                <button className=\"btn btn-primary\" onClick={loadAnalyticsData}>\r\n                  <RefreshCw className=\"w-4 h-4 mr-2\" />\r\n                  Refresh\r\n                </button>\r\n              </div>\r\n\r\n              {userRecommendations && (\r\n                <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6\">\r\n                  {/* User Preferences */}\r\n                  <div className=\"card p-6\">\r\n                    <h3 className=\"text-lg font-semibold text-gray-900 mb-4\">Your Preferences</h3>\r\n                    <div className=\"space-y-3\">\r\n                      {Object.entries(userRecommendations.preferences).map(([key, value]) => (\r\n                        <div key={key} className=\"flex items-center justify-between\">\r\n                          <span className=\"text-sm text-gray-600 capitalize\">{key}</span>\r\n                          <div className=\"flex items-center space-x-2\">\r\n                            <div className=\"w-20 bg-gray-200 rounded-full h-2\">\r\n                              <div \r\n                                className=\"bg-primary-500 h-2 rounded-full\" \r\n                                style={{ width: `${value * 100}%` }}\r\n                              ></div>\r\n                            </div>\r\n                            <span className=\"text-sm font-medium text-gray-900\">{Math.round(value * 100)}%</span>\r\n                          </div>\r\n                        </div>\r\n                      ))}\r\n                    </div>\r\n                  </div>\r\n\r\n                  {/* Recommendations */}\r\n                  <div className=\"card p-6\">\r\n                    <h3 className=\"text-lg font-semibold text-gray-900 mb-4\">Recommended Routes</h3>\r\n                    <div className=\"space-y-3\">\r\n                      {userRecommendations.recommendations.map((rec, index) => (\r\n                        <div key={index} className=\"border rounded-lg p-4 hover:bg-gray-50\">\r\n                          <div className=\"flex items-center justify-between mb-2\">\r\n                            <h4 className=\"font-medium text-gray-900\">{rec.routeName}</h4>\r\n                            <div className=\"flex items-center space-x-2\">\r\n                              <Star className=\"w-4 h-4 text-yellow-500\" />\r\n                              <span className=\"text-sm font-medium text-gray-900\">{rec.score}/100</span>\r\n                            </div>\r\n                          </div>\r\n                          <p className=\"text-sm text-gray-600 mb-2\">{rec.reason}</p>\r\n                          <div className=\"flex items-center space-x-2\">\r\n                            <span className={`px-2 py-1 text-xs rounded-full ${\r\n                              rec.type === 'efficiency' ? 'bg-blue-100 text-blue-800' :\r\n                              rec.type === 'safety' ? 'bg-green-100 text-green-800' :\r\n                              rec.type === 'cost' ? 'bg-yellow-100 text-yellow-800' :\r\n                              'bg-purple-100 text-purple-800'\r\n                            }`}>\r\n                              {rec.type}\r\n                            </span>\r\n                          </div>\r\n                        </div>\r\n                      ))}\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              )}\r\n\r\n              {/* Demand Forecasts */}\r\n              {demandForecasts.length > 0 && (\r\n                <div>\r\n                  <h3 className=\"text-xl font-semibold text-gray-900 mb-4\">Demand Forecasts</h3>\r\n                  <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-4\">\r\n                    {demandForecasts.map((forecast, index) => (\r\n                      <div key={index} className=\"card p-4\">\r\n                        <div className=\"flex items-center justify-between mb-2\">\r\n                          <h4 className=\"font-semibold text-gray-900\">Time Slot: {forecast.timeSlot}</h4>\r\n                          <div className=\"text-right\">\r\n                            <div className=\"text-lg font-bold text-primary-600\">{forecast.predictedDemand}%</div>\r\n                            <div className=\"text-sm text-gray-500\">{forecast.confidence}% confidence</div>\r\n                          </div>\r\n                        </div>\r\n                        <div className=\"w-full bg-gray-200 rounded-full h-2 mb-2\">\r\n                          <div \r\n                            className=\"bg-primary-500 h-2 rounded-full\" \r\n                            style={{ width: `${forecast.predictedDemand}%` }}\r\n                          ></div>\r\n                        </div>\r\n                        {forecast.recommendations.length > 0 && (\r\n                          <div className=\"text-sm text-gray-600\">\r\n                            {forecast.recommendations[0]}\r\n                          </div>\r\n                        )}\r\n                      </div>\r\n                    ))}\r\n                  </div>\r\n                </div>\r\n              )}\r\n            </div>\r\n          )}\r\n        </div>\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n"],"names":["AnalyticsDashboard","state","useApp","isLoading","setIsLoading","useState","error","setError","activeTab","setActiveTab","efficiencyScores","setEfficiencyScores","travelPredictions","setTravelPredictions","alternativeRoutes","setAlternativeRoutes","trendAnalysis","setTrendAnalysis","demandForecasts","setDemandForecasts","userRecommendations","setUserRecommendations","routes","setRoutes","selectedRoute","setSelectedRoute","availableStops","setAvailableStops","fromStop","setFromStop","toStop","setToStop","timeSlot","setTimeSlot","period","setPeriod","useEffect","res","apiService","simple","r","e","rt","stops","_a","s","prev","loadAnalyticsData","useCallback","recommendationsResponse","effResp","trendsResp","demandResp","handlePredictTravel","resp","handleFindAlternatives","getTrendIcon","trend","jsx","ArrowUp","ArrowDown","Minus","getTrendColor","getEfficiencyColor","score","getEfficiencyBgColor","jsxs","Loader2","AlertTriangle","RefreshCw","Target","Clock","TrendingUp","Star","tab","Icon","Filter","key","value","rec","index","CheckCircle","Zap","prediction","route","DollarSign","Calendar","data","insight","idx","forecast"],"mappings":"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"}