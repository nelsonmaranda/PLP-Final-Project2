import{u as L,a as M,j as e}from"./index-DdADWCqY.js";import{r as a}from"./vendor-BKU87Gzz.js";import{n as q,A as f,R as u,z as K,C as p,T as Z,i as y,F as _,u as H,Z as J,I as Y,k as G,J as Q,K as V,O as X}from"./icons-BF-AM-Tg.js";import"./router-hf4IkB-x.js";function ie(){var j;const{state:n}=L(),[N,l]=a.useState(!0),[o,d]=a.useState(null),[c,v]=a.useState("efficiency"),[b,w]=a.useState([]),[S,R]=a.useState([]),[h,T]=a.useState([]),[A,C]=a.useState([]),[g,D]=a.useState([]),[m,I]=a.useState(null),[E,O]=a.useState(""),[k,P]=a.useState("08:00"),[U,F]=a.useState("weekly"),x=a.useCallback(async()=>{var s;if(!((s=n.user)!=null&&s._id)){d("User not authenticated."),l(!1);return}l(!0),d(null);try{const[t]=await Promise.all([M.getUserRecommendations(n.user._id)]);t.success&&t.data&&I(t.data),w([{routeId:"1",routeName:"Route 46 - CBD to Westlands",efficiencyScore:85,factors:{reliability:80,speed:75,safety:90,comfort:85,cost:70,frequency:95},recommendations:["Increase frequency during peak hours","Improve vehicle comfort"],lastUpdated:new Date().toISOString()},{routeId:"2",routeName:"Route 34 - Eastleigh to CBD",efficiencyScore:72,factors:{reliability:65,speed:80,safety:75,comfort:70,cost:85,frequency:60},recommendations:["Improve on-time performance","Address safety concerns"],lastUpdated:new Date().toISOString()}]),R([{routeId:"1",fromStop:"Kencom",toStop:"Westlands",predictedTime:25,confidence:85,factors:{timeOfDay:1.2,dayOfWeek:1,weather:1.1,traffic:1.3,historical:.9},alternativeTimes:{optimistic:20,realistic:25,pessimistic:32},lastUpdated:new Date().toISOString()}]),T([{routeId:"2",routeName:"Route 34 - Alternative Route",totalTime:30,totalCost:45,efficiency:78,reasons:["Affordable fare","Multiple stops available"],stops:["Kencom","Museum Hill","Eastleigh","Westlands"]}]),C([{routeId:"1",period:"weekly",trends:{ridership:{current:150,previous:120,change:25,trend:"increasing"},efficiency:{current:85,previous:80,change:6.25,trend:"improving"},safety:{current:2,previous:5,change:-60,trend:"safer"},cost:{current:50,previous:50,change:0,trend:"stable"}},insights:["Ridership is increasing significantly","Safety incidents have decreased"],lastUpdated:new Date().toISOString()}]),D([{routeId:"1",timeSlot:"08:00",predictedDemand:85,confidence:80,factors:{historical:75,weather:1,events:1.1,seasonality:1},recommendations:["Consider increasing frequency during this time"],lastUpdated:new Date().toISOString()}])}catch(t){console.error("Error loading analytics data:",t),d("Failed to load analytics data. Please try again.")}finally{l(!1)}},[(j=n.user)==null?void 0:j._id]);a.useEffect(()=>{x()},[x]);const $=s=>{switch(s){case"increasing":case"improving":case"safer":return e.jsx(X,{className:"w-4 h-4 text-green-500"});case"decreasing":case"declining":case"riskier":return e.jsx(V,{className:"w-4 h-4 text-red-500"});default:return e.jsx(Q,{className:"w-4 h-4 text-gray-500"})}},z=s=>{switch(s){case"increasing":case"improving":case"safer":return"text-green-600";case"decreasing":case"declining":case"riskier":return"text-red-600";default:return"text-gray-600"}},W=s=>s>=80?"text-green-600":s>=60?"text-yellow-600":"text-red-600",B=s=>s>=80?"bg-green-100":s>=60?"bg-yellow-100":"bg-red-100";return N?e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:e.jsxs("div",{className:"text-center",children:[e.jsx(q,{className:"h-10 w-10 text-primary-500 animate-spin"}),e.jsx("p",{className:"text-gray-600 mt-4",children:"Loading Advanced Analytics..."})]})}):o?e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:e.jsxs("div",{className:"text-center p-6 bg-white rounded-lg shadow-md",children:[e.jsx(f,{className:"h-12 w-12 text-red-500 mx-auto mb-4"}),e.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-2",children:"Error Loading Analytics"}),e.jsx("p",{className:"text-gray-600 mb-4",children:o}),e.jsxs("button",{onClick:x,className:"btn btn-primary",children:[e.jsx(u,{className:"w-4 h-4 mr-2"}),"Retry"]})]})}):e.jsx("div",{className:"min-h-screen bg-gray-50",children:e.jsxs("div",{className:"px-6 py-8",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Advanced Analytics"}),e.jsx("p",{className:"text-gray-600",children:"Comprehensive insights and predictions for route optimization"})]}),e.jsx("div",{className:"mb-8",children:e.jsx("div",{className:"border-b border-gray-200",children:e.jsx("nav",{className:"-mb-px flex space-x-8",children:[{id:"efficiency",name:"Route Efficiency",icon:K},{id:"predictions",name:"Travel Predictions",icon:p},{id:"trends",name:"Trend Analysis",icon:Z},{id:"recommendations",name:"Recommendations",icon:y}].map(s=>{const t=s.icon;return e.jsxs("button",{onClick:()=>v(s.id),className:`flex items-center space-x-2 py-2 px-1 border-b-2 font-medium text-sm ${c===s.id?"border-primary-500 text-primary-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[e.jsx(t,{className:"w-4 h-4"}),e.jsx("span",{children:s.name})]},s.id)})})})}),e.jsxs("div",{className:"space-y-6",children:[c==="efficiency"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Route Efficiency Scores"}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("select",{value:E,onChange:s=>O(s.target.value),className:"form-select",children:[e.jsx("option",{value:"",children:"All Routes"}),e.jsx("option",{value:"1",children:"Route 46 - CBD to Westlands"}),e.jsx("option",{value:"2",children:"Route 34 - Eastleigh to CBD"})]}),e.jsxs("button",{className:"btn btn-outline",children:[e.jsx(_,{className:"w-4 h-4 mr-2"}),"Filter"]})]})]}),e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:b.map(s=>e.jsxs("div",{className:"card p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:s.routeName}),e.jsxs("div",{className:`px-3 py-1 rounded-full text-sm font-medium ${B(s.efficiencyScore)} ${W(s.efficiencyScore)}`,children:[s.efficiencyScore,"/100"]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"grid grid-cols-2 gap-4",children:Object.entries(s.factors).map(([t,i])=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600 capitalize",children:t}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-16 bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-primary-500 h-2 rounded-full",style:{width:`${i}%`}})}),e.jsx("span",{className:"text-sm font-medium text-gray-900",children:i})]})]},t))}),s.recommendations.length>0&&e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-gray-900 mb-2",children:"Recommendations"}),e.jsx("ul",{className:"space-y-1",children:s.recommendations.map((t,i)=>e.jsxs("li",{className:"flex items-start space-x-2 text-sm text-gray-600",children:[e.jsx(H,{className:"w-4 h-4 text-green-500 mt-0.5 flex-shrink-0"}),e.jsx("span",{children:t})]},i))})]})]})]},s.routeId))})]}),c==="predictions"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Travel Time Predictions"}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("input",{type:"time",value:k,onChange:s=>P(s.target.value),className:"form-input"}),e.jsxs("button",{className:"btn btn-primary",children:[e.jsx(J,{className:"w-4 h-4 mr-2"}),"Predict"]})]})]}),e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:S.map((s,t)=>e.jsxs("div",{className:"card p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900",children:[s.fromStop," â†’ ",s.toStop]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-2xl font-bold text-primary-600",children:[s.predictedTime," min"]}),e.jsxs("div",{className:"text-sm text-gray-500",children:[s.confidence,"% confidence"]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{className:"text-center p-3 bg-green-50 rounded-lg",children:[e.jsxs("div",{className:"text-lg font-semibold text-green-600",children:[s.alternativeTimes.optimistic," min"]}),e.jsx("div",{className:"text-xs text-green-600",children:"Optimistic"})]}),e.jsxs("div",{className:"text-center p-3 bg-blue-50 rounded-lg",children:[e.jsxs("div",{className:"text-lg font-semibold text-blue-600",children:[s.alternativeTimes.realistic," min"]}),e.jsx("div",{className:"text-xs text-blue-600",children:"Realistic"})]}),e.jsxs("div",{className:"text-center p-3 bg-red-50 rounded-lg",children:[e.jsxs("div",{className:"text-lg font-semibold text-red-600",children:[s.alternativeTimes.pessimistic," min"]}),e.jsx("div",{className:"text-xs text-red-600",children:"Pessimistic"})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-gray-900 mb-2",children:"Factors"}),e.jsx("div",{className:"grid grid-cols-2 gap-2 text-sm",children:Object.entries(s.factors).map(([i,r])=>e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600 capitalize",children:i.replace(/([A-Z])/g," $1")}),e.jsxs("span",{className:"font-medium",children:[r.toFixed(2),"x"]})]},i))})]})]})]},t))}),h.length>0&&e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Alternative Routes"}),e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:h.map((s,t)=>e.jsxs("div",{className:"card p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h4",{className:"font-semibold text-gray-900",children:s.routeName}),e.jsxs("div",{className:"text-sm text-gray-500",children:[s.efficiency,"/100"]})]}),e.jsxs("div",{className:"flex items-center space-x-4 text-sm text-gray-600",children:[e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(p,{className:"w-4 h-4"}),e.jsxs("span",{children:[s.totalTime," min"]})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(Y,{className:"w-4 h-4"}),e.jsxs("span",{children:["Ksh ",s.totalCost]})]})]}),e.jsx("div",{className:"mt-2",children:e.jsxs("div",{className:"text-xs text-gray-500",children:["Reasons: ",s.reasons.join(", ")]})})]},t))})]})]}),c==="trends"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Trend Analysis"}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("select",{value:U,onChange:s=>F(s.target.value),className:"form-select",children:[e.jsx("option",{value:"daily",children:"Daily"}),e.jsx("option",{value:"weekly",children:"Weekly"}),e.jsx("option",{value:"monthly",children:"Monthly"})]}),e.jsxs("button",{className:"btn btn-outline",children:[e.jsx(G,{className:"w-4 h-4 mr-2"}),"Update"]})]})]}),e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:A.map((s,t)=>e.jsxs("div",{className:"card p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:["Route Trends (",s.period,")"]}),e.jsx("div",{className:"space-y-4",children:Object.entries(s.trends).map(([i,r])=>e.jsxs("div",{className:"border rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"font-medium text-gray-900 capitalize",children:i}),e.jsxs("div",{className:"flex items-center space-x-2",children:[$(r.trend),e.jsxs("span",{className:`text-sm font-medium ${z(r.trend)}`,children:[r.change>0?"+":"",r.change.toFixed(1),"%"]})]})]}),e.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-600",children:[e.jsxs("span",{children:["Current: ",r.current]}),e.jsxs("span",{children:["Previous: ",r.previous]})]})]},i))}),s.insights.length>0&&e.jsxs("div",{className:"mt-4",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-900 mb-2",children:"Insights"}),e.jsx("ul",{className:"space-y-1",children:s.insights.map((i,r)=>e.jsxs("li",{className:"flex items-start space-x-2 text-sm text-gray-600",children:[e.jsx(f,{className:"w-4 h-4 text-blue-500 mt-0.5 flex-shrink-0"}),e.jsx("span",{children:i})]},r))})]})]},t))})]}),c==="recommendations"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Personalized Recommendations"}),e.jsxs("button",{className:"btn btn-primary",children:[e.jsx(u,{className:"w-4 h-4 mr-2"}),"Refresh"]})]}),m&&e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"card p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Your Preferences"}),e.jsx("div",{className:"space-y-3",children:Object.entries(m.preferences).map(([s,t])=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600 capitalize",children:s}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-20 bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-primary-500 h-2 rounded-full",style:{width:`${t*100}%`}})}),e.jsxs("span",{className:"text-sm font-medium text-gray-900",children:[Math.round(t*100),"%"]})]})]},s))})]}),e.jsxs("div",{className:"card p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Recommended Routes"}),e.jsx("div",{className:"space-y-3",children:m.recommendations.map((s,t)=>e.jsxs("div",{className:"border rounded-lg p-4 hover:bg-gray-50",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h4",{className:"font-medium text-gray-900",children:s.routeName}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(y,{className:"w-4 h-4 text-yellow-500"}),e.jsxs("span",{className:"text-sm font-medium text-gray-900",children:[s.score,"/100"]})]})]}),e.jsx("p",{className:"text-sm text-gray-600 mb-2",children:s.reason}),e.jsx("div",{className:"flex items-center space-x-2",children:e.jsx("span",{className:`px-2 py-1 text-xs rounded-full ${s.type==="efficiency"?"bg-blue-100 text-blue-800":s.type==="safety"?"bg-green-100 text-green-800":s.type==="cost"?"bg-yellow-100 text-yellow-800":"bg-purple-100 text-purple-800"}`,children:s.type})})]},t))})]})]}),g.length>0&&e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Demand Forecasts"}),e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:g.map((s,t)=>e.jsxs("div",{className:"card p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("h4",{className:"font-semibold text-gray-900",children:["Time Slot: ",s.timeSlot]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-lg font-bold text-primary-600",children:[s.predictedDemand,"%"]}),e.jsxs("div",{className:"text-sm text-gray-500",children:[s.confidence,"% confidence"]})]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2 mb-2",children:e.jsx("div",{className:"bg-primary-500 h-2 rounded-full",style:{width:`${s.predictedDemand}%`}})}),s.recommendations.length>0&&e.jsx("div",{className:"text-sm text-gray-600",children:s.recommendations[0]})]},t))})]})]})]})]})})}export{ie as default};
//# sourceMappingURL=AnalyticsDashboard-Czo9SBZE.js.map
