import{j as e,b as O,u as U,a as D}from"./index-CqLwKMol.js";import{r as n}from"./vendor-BKU87Gzz.js";import{b as L,L as g}from"./router-Z6rqMkFf.js";import{U as v,b as P,G as R,f as q,w as T,o as G,s as z,i as I,t as B,u as Y,E as H,q as J,v as K}from"./icons-laTIaZ17.js";function Z({selectedRole:u,onRoleChange:y,language:a}){var d;const x=[{id:"user",name:a==="sw"?"Mtumiaji wa Kawaida":"Regular User",description:a==="sw"?"Pata taarifa za matatu na uwasilie ripoti":"Get matatu information and submit reports",icon:v,color:"bg-gray-100 text-gray-800 border-gray-300",selectedColor:"bg-gray-200 text-gray-900 border-gray-400"},{id:"sacco",name:a==="sw"?"Meneja wa SACCO":"SACCO Manager",description:a==="sw"?"Dhibiti gari na madereva wa SACCO yako":"Manage your SACCO vehicles and drivers",icon:P,color:"bg-blue-100 text-blue-800 border-blue-300",selectedColor:"bg-blue-200 text-blue-900 border-blue-400"},{id:"authority",name:a==="sw"?"Mamlaka ya Usafiri":"Transport Authority",description:a==="sw"?"Fuatilia uzingo na usalama wa usafiri":"Monitor compliance and transport safety",icon:R,color:"bg-red-100 text-red-800 border-red-300",selectedColor:"bg-red-200 text-red-900 border-red-400"},{id:"moderator",name:a==="sw"?"Msimamizi":"Moderator",description:a==="sw"?"Simamia mfumo na uwasilie ripoti":"Moderate system and generate reports",icon:q,color:"bg-green-100 text-green-800 border-green-300",selectedColor:"bg-green-200 text-green-900 border-green-400"},{id:"admin",name:a==="sw"?"Msimamizi Mkuu":"Administrator",description:a==="sw"?"Dhibiti mfumo wote na ufikie dashboards zote":"Control entire system and access all dashboards",icon:T,color:"bg-purple-100 text-purple-800 border-purple-300",selectedColor:"bg-purple-200 text-purple-900 border-purple-400"}];return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:a==="sw"?"Chagua Aina ya Mtumiaji":"Select User Type"}),e.jsx("p",{className:"text-sm text-gray-500 mb-4",children:a==="sw"?"Chagua aina ya mtumiaji kulingana na jukumu lako":"Choose user type based on your role"})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:x.map(i=>{const c=i.icon,m=u===i.id;return e.jsx("button",{type:"button",onClick:()=>y(i.id),className:`p-4 rounded-lg border-2 text-left transition-all duration-200 hover:shadow-md ${m?`${i.selectedColor} shadow-md`:`${i.color} hover:shadow-sm`}`,children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("div",{className:`p-2 rounded-lg ${m?"bg-white":"bg-white/50"}`,children:e.jsx(c,{className:`w-6 h-6 ${m?"text-gray-700":"text-gray-500"}`})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"text-sm font-semibold",children:i.name}),e.jsx("p",{className:"text-xs mt-1 opacity-80",children:i.description})]}),m&&e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"w-5 h-5 bg-blue-600 rounded-full flex items-center justify-center",children:e.jsx("div",{className:"w-2 h-2 bg-white rounded-full"})})})]})},i.id)})}),u&&e.jsxs("div",{className:"mt-4 p-3 bg-blue-50 rounded-lg",children:[e.jsxs("p",{className:"text-sm text-blue-800",children:[e.jsx("strong",{children:a==="sw"?"Umechagua:":"Selected:"})," ",(d=x.find(i=>i.id===u))==null?void 0:d.name]}),e.jsx("p",{className:"text-xs text-blue-600 mt-1",children:a==="sw"?"Utapata ufikiaji wa dashboards na huduma za maalum kulingana na jukumu lako":"You will have access to specific dashboards and services based on your role"})]})]})}function _(){const{setUser:u,state:y}=O(),{t:a}=U(),x=L(),[d,i]=n.useState(!1),[c,m]=n.useState(!1),[p,h]=n.useState(null),[N,f]=n.useState(!1),[j,C]=n.useState("user"),[t,S]=n.useState({displayName:"",email:"",password:""}),[k,A]=n.useState(""),[s,E]=n.useState({}),b=n.useCallback(r=>{const{name:l,value:o}=r.target;S(w=>({...w,[l]:o})),s[l]&&E(w=>({...w,[l]:""})),p&&h(null),N&&f(!1)},[s,p,N]),M=()=>{const r={};return t.displayName.trim()||(r.displayName="Display name is required"),t.email.trim()?/\S+@\S+\.\S+/.test(t.email)||(r.email="Email is invalid"):r.email="Email is required",t.password?t.password.length<8&&(r.password="Password must be at least 8 characters"):r.password="Password is required",E(r),Object.keys(r).length===0},F=async r=>{if(r.preventDefault(),!!M()){i(!0),h(null),f(!1);try{const l={...t,role:j,organization:k},o=await D.signup(l);o.success&&o.data&&o.data.user&&o.data.token?(u(o.data.user),f(!0),S({displayName:"",email:"",password:""}),C("user"),setTimeout(()=>{x("/")},1500)):h("Registration failed. Please check your information and try again.")}catch(l){console.error("Signup error:",l),h("Failed to create account. Please check your information and try again.")}finally{i(!1)}}},$=[{text:"At least 8 characters",met:t.password.length>=8},{text:"Contains uppercase letter",met:/[A-Z]/.test(t.password)},{text:"Contains lowercase letter",met:/[a-z]/.test(t.password)},{text:"Contains number",met:/\d/.test(t.password)}];return e.jsxs("div",{className:"min-h-screen bg-gray-50 flex flex-col justify-center py-12 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"sm:mx-auto sm:w-full sm:max-w-md",children:[e.jsx("div",{className:"flex justify-center",children:e.jsxs(g,{to:"/",className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-10 h-10 bg-primary-500 rounded-lg flex items-center justify-center",children:e.jsx(v,{className:"w-6 h-6 text-white"})}),e.jsx("span",{className:"text-2xl font-bold text-gray-900",children:"Smart Matatu"})]})}),e.jsx("h1",{className:"mt-6 text-center text-3xl font-bold text-gray-900",children:"Create your account"}),e.jsx("p",{className:"mt-2 text-center text-sm text-gray-600",children:"Join thousands of Nairobi commuters"})]}),e.jsxs("div",{className:"mt-8 sm:mx-auto sm:w-full sm:max-w-md",children:[e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-content",children:[p&&e.jsx("div",{className:"mb-6 p-4 bg-red-50 border border-red-200 rounded-lg",role:"alert","aria-live":"polite",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(G,{className:"h-5 w-5 text-red-400","aria-hidden":"true"})}),e.jsx("div",{className:"ml-3",children:e.jsx("p",{className:"text-sm font-medium text-red-800",children:p})})]})}),N&&e.jsx("div",{className:"mb-6 p-4 bg-green-50 border border-green-200 rounded-lg",role:"alert","aria-live":"polite",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(z,{className:"h-5 w-5 text-green-400","aria-hidden":"true"})}),e.jsx("div",{className:"ml-3",children:e.jsx("p",{className:"text-sm font-medium text-green-800",children:"Account created successfully! You can now sign in with your credentials."})})]})}),e.jsxs("form",{onSubmit:F,className:"space-y-6",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"displayName",className:"form-label",children:a("auth.displayName")}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(v,{className:"h-5 w-5 text-gray-400","aria-hidden":"true"})}),e.jsx("input",{id:"displayName",name:"displayName",type:"text",autoComplete:"name",value:t.displayName,onChange:b,className:`form-input pl-10 ${s.displayName?"border-red-500":""}`,placeholder:"Enter your display name","aria-describedby":s.displayName?"displayName-error":"displayName-help","aria-invalid":!!s.displayName})]}),s.displayName&&e.jsx("p",{className:"form-error","data-testid":"displayName-error",id:"displayName-error",role:"alert",children:s.displayName}),e.jsx("p",{id:"displayName-help",className:"sr-only",children:"Enter your display name as it will appear to other users"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"email",className:"form-label",children:a("auth.email")}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(I,{className:"h-5 w-5 text-gray-400","aria-hidden":"true"})}),e.jsx("input",{id:"email",name:"email",type:"email",autoComplete:"email",value:t.email,onChange:b,className:`form-input pl-10 ${s.email?"border-red-500":""}`,placeholder:"Enter your email","aria-describedby":s.email?"email-error":"email-help","aria-invalid":!!s.email})]}),s.email&&e.jsx("p",{className:"form-error","data-testid":"email-error",id:"email-error",role:"alert",children:s.email}),e.jsx("p",{id:"email-help",className:"sr-only",children:"Enter your email address for account verification"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"password",className:"form-label",children:a("auth.password")}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(B,{className:"h-5 w-5 text-gray-400","aria-hidden":"true"})}),e.jsx("input",{id:"password",name:"password",type:c?"text":"password",autoComplete:"new-password",value:t.password,onChange:b,className:`form-input pl-10 pr-10 ${s.password?"border-red-500":""}`,placeholder:"Create a password","aria-describedby":s.password?"password-error":"password-help","aria-invalid":!!s.password}),e.jsx("button",{type:"button",className:"absolute inset-y-0 right-0 pr-3 flex items-center",onClick:()=>m(!c),"aria-label":c?"Hide password":"Show password",children:c?e.jsx(Y,{className:"h-5 w-5 text-gray-400","aria-hidden":"true"}):e.jsx(H,{className:"h-5 w-5 text-gray-400","aria-hidden":"true"})})]}),s.password&&e.jsx("p",{className:"form-error","data-testid":"password-error",id:"password-error",role:"alert",children:s.password}),e.jsx("p",{id:"password-help",className:"sr-only",children:"Create a password with at least 8 characters"}),t.password&&e.jsx("div",{className:"mt-2 space-y-1",children:$.map((r,l)=>e.jsxs("div",{className:"flex items-center text-xs",children:[e.jsx(z,{className:`w-3 h-3 mr-2 ${r.met?"text-green-500":"text-gray-400"}`}),e.jsx("span",{className:r.met?"text-green-600":"text-gray-500",children:r.text})]},l))})]}),e.jsx("div",{className:"form-group",children:e.jsx(Z,{selectedRole:j,onRoleChange:C,language:y.language})}),["sacco","authority","moderator","admin"].includes(j)&&e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"organization",className:"form-label",children:"Organization Name"}),e.jsx("input",{id:"organization",name:"organization",type:"text",value:k,onChange:r=>A(r.target.value),className:"form-input",placeholder:"Enter your organization name",required:!0}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"This helps us verify your role request"})]}),e.jsx("div",{children:e.jsx("button",{type:"submit",disabled:d,className:"btn btn-primary w-full","aria-label":d?"Creating account...":"Create your account",children:d?e.jsxs(e.Fragment,{children:[e.jsx(J,{className:"w-4 h-4 mr-2 animate-spin","aria-hidden":"true"}),"Creating account..."]}):"Create account"})}),e.jsx("div",{className:"text-center",children:e.jsxs("p",{className:"text-sm text-gray-600",children:["Already have an account?"," ",e.jsx(g,{to:"/login",className:"font-medium text-primary-600 hover:text-primary-500",children:"Sign in here"})]})})]})]})}),e.jsx("div",{className:"mt-6 text-center",children:e.jsxs(g,{to:"/",className:"inline-flex items-center text-sm text-gray-600 hover:text-gray-900",children:[e.jsx(K,{className:"w-4 h-4 mr-2"}),"Back to home"]})})]})]})}export{_ as default};
//# sourceMappingURL=Signup-BVmV6Oo6.js.map
