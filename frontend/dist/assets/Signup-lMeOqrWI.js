import{u as k,j as e,a as j}from"./index-2y-IcQw3.js";import{r as l}from"./vendor-BKU87Gzz.js";import{L as u}from"./router-hf4IkB-x.js";import{U as w,g as A,j as g,b as P,k as F,E as L,l as D,h as U,m as $}from"./icons-BoF6UaG_.js";function O(){const{setUser:v}=k(),[m,N]=l.useState(!1),[d,b]=l.useState(!1),[o,i]=l.useState(null),[p,c]=l.useState(!1),[r,y]=l.useState({displayName:"",email:"",password:""}),[s,f]=l.useState({}),x=l.useCallback(a=>{const{name:t,value:n}=a.target;y(h=>({...h,[t]:n})),s[t]&&f(h=>({...h,[t]:""})),o&&i(null),p&&c(!1)},[s,o,p]),C=()=>{const a={};return r.displayName.trim()||(a.displayName="Display name is required"),r.email.trim()?/\S+@\S+\.\S+/.test(r.email)||(a.email="Email is invalid"):a.email="Email is required",r.password?r.password.length<8&&(a.password="Password must be at least 8 characters"):a.password="Password is required",f(a),Object.keys(a).length===0},S=async a=>{if(a.preventDefault(),!!C()){N(!0),i(null),c(!1);try{const t=await j.signup(r);if(t.success&&t.data&&t.data.user&&t.data.token){const n=await j.getCurrentUser();n&&n._id?(v(n),c(!0),y({displayName:"",email:"",password:""}),setTimeout(()=>c(!1),3e3)):i("Account created but authentication failed. Please try logging in.")}else i("Registration failed. Please check your information and try again.")}catch(t){console.error("Signup error:",t),i("Failed to create account. Please check your information and try again.")}finally{N(!1)}}},E=[{text:"At least 8 characters",met:r.password.length>=8},{text:"Contains uppercase letter",met:/[A-Z]/.test(r.password)},{text:"Contains lowercase letter",met:/[a-z]/.test(r.password)},{text:"Contains number",met:/\d/.test(r.password)}];return e.jsxs("div",{className:"min-h-screen bg-gray-50 flex flex-col justify-center py-12 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"sm:mx-auto sm:w-full sm:max-w-md",children:[e.jsx("div",{className:"flex justify-center",children:e.jsxs(u,{to:"/",className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-10 h-10 bg-primary-500 rounded-lg flex items-center justify-center",children:e.jsx(w,{className:"w-6 h-6 text-white"})}),e.jsx("span",{className:"text-2xl font-bold text-gray-900",children:"Smart Matatu"})]})}),e.jsx("h1",{className:"mt-6 text-center text-3xl font-bold text-gray-900",children:"Create your account"}),e.jsx("p",{className:"mt-2 text-center text-sm text-gray-600",children:"Join thousands of Nairobi commuters"})]}),e.jsxs("div",{className:"mt-8 sm:mx-auto sm:w-full sm:max-w-md",children:[e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-content",children:[o&&e.jsx("div",{className:"mb-6 p-4 bg-red-50 border border-red-200 rounded-lg",role:"alert","aria-live":"polite",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(A,{className:"h-5 w-5 text-red-400","aria-hidden":"true"})}),e.jsx("div",{className:"ml-3",children:e.jsx("p",{className:"text-sm font-medium text-red-800",children:o})})]})}),p&&e.jsx("div",{className:"mb-6 p-4 bg-green-50 border border-green-200 rounded-lg",role:"alert","aria-live":"polite",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(g,{className:"h-5 w-5 text-green-400","aria-hidden":"true"})}),e.jsx("div",{className:"ml-3",children:e.jsx("p",{className:"text-sm font-medium text-green-800",children:"Account created successfully! You can now sign in with your credentials."})})]})}),e.jsxs("form",{onSubmit:S,className:"space-y-6",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"displayName",className:"form-label",children:"Display Name"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(w,{className:"h-5 w-5 text-gray-400","aria-hidden":"true"})}),e.jsx("input",{id:"displayName",name:"displayName",type:"text",autoComplete:"name",value:r.displayName,onChange:x,className:`form-input pl-10 ${s.displayName?"border-red-500":""}`,placeholder:"Enter your display name","aria-describedby":s.displayName?"displayName-error":"displayName-help","aria-invalid":!!s.displayName})]}),s.displayName&&e.jsx("p",{className:"form-error","data-testid":"displayName-error",id:"displayName-error",role:"alert",children:s.displayName}),e.jsx("p",{id:"displayName-help",className:"sr-only",children:"Enter your display name as it will appear to other users"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"email",className:"form-label",children:"Email address"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(P,{className:"h-5 w-5 text-gray-400","aria-hidden":"true"})}),e.jsx("input",{id:"email",name:"email",type:"email",autoComplete:"email",value:r.email,onChange:x,className:`form-input pl-10 ${s.email?"border-red-500":""}`,placeholder:"Enter your email","aria-describedby":s.email?"email-error":"email-help","aria-invalid":!!s.email})]}),s.email&&e.jsx("p",{className:"form-error","data-testid":"email-error",id:"email-error",role:"alert",children:s.email}),e.jsx("p",{id:"email-help",className:"sr-only",children:"Enter your email address for account verification"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"password",className:"form-label",children:"Password"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(F,{className:"h-5 w-5 text-gray-400","aria-hidden":"true"})}),e.jsx("input",{id:"password",name:"password",type:d?"text":"password",autoComplete:"new-password",value:r.password,onChange:x,className:`form-input pl-10 pr-10 ${s.password?"border-red-500":""}`,placeholder:"Create a password","aria-describedby":s.password?"password-error":"password-help","aria-invalid":!!s.password}),e.jsx("button",{type:"button",className:"absolute inset-y-0 right-0 pr-3 flex items-center",onClick:()=>b(!d),"aria-label":d?"Hide password":"Show password",children:d?e.jsx(L,{className:"h-5 w-5 text-gray-400","aria-hidden":"true"}):e.jsx(D,{className:"h-5 w-5 text-gray-400","aria-hidden":"true"})})]}),s.password&&e.jsx("p",{className:"form-error","data-testid":"password-error",id:"password-error",role:"alert",children:s.password}),e.jsx("p",{id:"password-help",className:"sr-only",children:"Create a password with at least 8 characters"}),r.password&&e.jsx("div",{className:"mt-2 space-y-1",children:E.map((a,t)=>e.jsxs("div",{className:"flex items-center text-xs",children:[e.jsx(g,{className:`w-3 h-3 mr-2 ${a.met?"text-green-500":"text-gray-400"}`}),e.jsx("span",{className:a.met?"text-green-600":"text-gray-500",children:a.text})]},t))})]}),e.jsx("div",{children:e.jsx("button",{type:"submit",disabled:m,className:"btn btn-primary w-full","aria-label":m?"Creating account...":"Create your account",children:m?e.jsxs(e.Fragment,{children:[e.jsx(U,{className:"w-4 h-4 mr-2 animate-spin","aria-hidden":"true"}),"Creating account..."]}):"Create account"})}),e.jsx("div",{className:"text-center",children:e.jsxs("p",{className:"text-sm text-gray-600",children:["Already have an account?"," ",e.jsx(u,{to:"/login",className:"font-medium text-primary-600 hover:text-primary-500",children:"Sign in here"})]})})]})]})}),e.jsx("div",{className:"mt-6 text-center",children:e.jsxs(u,{to:"/",className:"inline-flex items-center text-sm text-gray-600 hover:text-gray-900",children:[e.jsx($,{className:"w-4 h-4 mr-2"}),"Back to home"]})})]})]})}export{O as default};
//# sourceMappingURL=Signup-lMeOqrWI.js.map
