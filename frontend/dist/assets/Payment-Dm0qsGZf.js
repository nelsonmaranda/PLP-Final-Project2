import{u as P,b as w,j as e,a as h}from"./index-BRy-12qz.js";import{r as l}from"./vendor-BKU87Gzz.js";import{b as C,c as S}from"./router-BF-yxxER.js";import"./icons-B9e0n2uV.js";const A=()=>{const{t:j}=P(),{state:p}=w(),m=C(),[n]=S(),[s,y]=l.useState(null),[b,f]=l.useState(!0),[o,i]=l.useState(!1),[c,r]=l.useState(null),[x,u]=l.useState("stripe");l.useEffect(()=>{const t=n.get("plan"),a=n.get("amount"),d=n.get("planName");if(!t||!a){r("Invalid payment data. Please select a plan again."),f(!1);return}const v={free:["Basic route information","Submit 5 reports per month","Community support"],premium:["Unlimited reports","Advanced analytics","Priority support","Real-time notifications"],sacco:["All Premium features","Revenue analytics","Custom branding","API access","Dedicated support"],enterprise:["All SACCO features","White-label solution","Custom integrations","24/7 support","SLA guarantee"]};y({amount:parseInt(a),currency:"KES",description:`${d||t} subscription`,planType:t,planName:d||t,features:v[t]||[]}),f(!1)},[n]);const N=async()=>{if(!(!s||!p.user)){i(!0),r(null);try{if(p.user.email==="nelsonmaranda2@gmail.com"){(await h.confirmPayment("admin_payment",s.planType)).success&&m("/subscription?success=true&plan="+s.planType);return}const t=await h.createPaymentIntent(s.amount,s.currency,s.description);t.success&&t.data?setTimeout(async()=>{var a;try{(await h.confirmPayment(((a=t.data)==null?void 0:a.paymentId)||"",s.planType)).success?m("/subscription?success=true&plan="+s.planType):r("Payment confirmation failed. Please try again.")}catch{r("Payment confirmation failed. Please try again.")}finally{i(!1)}},2e3):(r("Failed to create payment. Please try again."),i(!1))}catch{r("Payment failed. Please try again."),i(!1)}}},g=()=>{m("/subscription")};return b?e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),e.jsx("p",{className:"mt-4 text-gray-600",children:j("common.loading")})]})}):c&&!s?e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsx("div",{className:"text-center",children:e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-md p-6 max-w-md",children:e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("svg",{className:"h-5 w-5 text-red-400",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})}),e.jsxs("div",{className:"ml-3",children:[e.jsx("h3",{className:"text-sm font-medium text-red-800",children:"Payment Error"}),e.jsx("p",{className:"mt-1 text-sm text-red-700",children:c}),e.jsx("button",{onClick:g,className:"mt-3 bg-red-100 text-red-800 px-3 py-1 rounded-md text-sm hover:bg-red-200",children:"Back to Plans"})]})]})})})}):e.jsx("div",{className:"min-h-screen bg-gray-50 py-8",children:e.jsxs("div",{className:"max-w-2xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Complete Your Payment"}),e.jsxs("p",{className:"text-gray-600",children:["Secure payment for your ",s==null?void 0:s.planName," subscription"]})]}),e.jsxs("div",{className:"bg-white shadow rounded-lg mb-8",children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:e.jsx("h2",{className:"text-lg font-medium text-gray-900",children:"Order Summary"})}),e.jsxs("div",{className:"px-6 py-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-medium text-gray-900",children:[s==null?void 0:s.planName," Plan"]}),e.jsx("p",{className:"text-sm text-gray-500",children:"Monthly subscription"})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:(s==null?void 0:s.amount)===0?"Free":`KES ${s==null?void 0:s.amount.toLocaleString()}`}),s&&s.amount>0&&e.jsx("p",{className:"text-sm text-gray-500",children:"per month"})]})]}),e.jsxs("div",{className:"border-t border-gray-200 pt-4",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-900 mb-2",children:"Plan Features:"}),e.jsx("ul",{className:"space-y-1",children:s==null?void 0:s.features.map((t,a)=>e.jsxs("li",{className:"flex items-center text-sm text-gray-600",children:[e.jsx("svg",{className:"h-4 w-4 text-green-500 mr-2",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),t]},a))})]})]})]}),e.jsxs("div",{className:"bg-white shadow rounded-lg mb-8",children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:e.jsx("h2",{className:"text-lg font-medium text-gray-900",children:"Payment Method"})}),e.jsx("div",{className:"px-6 py-4",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{id:"stripe",name:"payment-method",type:"radio",value:"stripe",checked:x==="stripe",onChange:t=>u(t.target.value),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300"}),e.jsxs("label",{htmlFor:"stripe",className:"ml-3 flex items-center",children:[e.jsx("svg",{className:"h-6 w-6 mr-2",viewBox:"0 0 24 24",fill:"currentColor",children:e.jsx("path",{d:"M13.976 9.15c-2.172-.806-3.356-1.426-3.356-2.409 0-.831.683-1.305 1.901-1.305 2.227 0 4.515.858 6.09 1.631l.89-5.494C18.252.274 15.697 0 12.165 0 9.667 0 7.589.654 6.104 1.872 4.56 3.147 3.757 4.992 3.757 7.218c0 4.039 2.467 5.76 6.476 7.219 2.585.92 3.445 1.574 3.445 2.583 0 .98-.84 1.573-2.354 1.573-1.875 0-4.965-.921-6.99-2.109l-.9 5.555C5.175 22.99 8.385 24 11.714 24c2.641 0 4.843-.624 6.328-1.813 1.664-1.305 2.525-3.236 2.525-5.732 0-4.128-2.524-5.851-6.591-7.305z"})}),e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Credit/Debit Card"})]})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{id:"mpesa",name:"payment-method",type:"radio",value:"mpesa",checked:x==="mpesa",onChange:t=>u(t.target.value),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300"}),e.jsxs("label",{htmlFor:"mpesa",className:"ml-3 flex items-center",children:[e.jsx("div",{className:"h-6 w-6 mr-2 bg-green-600 rounded flex items-center justify-center",children:e.jsx("span",{className:"text-white text-xs font-bold",children:"M"})}),e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"M-Pesa"})]})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{id:"airtel",name:"payment-method",type:"radio",value:"airtel",checked:x==="airtel",onChange:t=>u(t.target.value),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300"}),e.jsxs("label",{htmlFor:"airtel",className:"ml-3 flex items-center",children:[e.jsx("div",{className:"h-6 w-6 mr-2 bg-red-600 rounded flex items-center justify-center",children:e.jsx("span",{className:"text-white text-xs font-bold",children:"A"})}),e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Airtel Money"})]})]})]})})]}),c&&e.jsx("div",{className:"mb-6 bg-red-50 border border-red-200 rounded-md p-4",children:e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("svg",{className:"h-5 w-5 text-red-400",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})}),e.jsx("div",{className:"ml-3",children:e.jsx("p",{className:"text-sm text-red-800",children:c})})]})}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[e.jsx("button",{onClick:g,className:"flex-1 bg-gray-300 text-gray-700 py-3 px-4 rounded-md font-medium hover:bg-gray-400 transition-colors",children:"Back to Plans"}),e.jsx("button",{onClick:N,disabled:o||(s==null?void 0:s.amount)===0,className:`flex-1 py-3 px-4 rounded-md font-medium transition-colors ${o||(s==null?void 0:s.amount)===0?"bg-gray-300 text-gray-500 cursor-not-allowed":"bg-blue-600 text-white hover:bg-blue-700"}`,children:o?e.jsxs("div",{className:"flex items-center justify-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Processing Payment..."]}):(s==null?void 0:s.amount)===0?"Activate Free Plan":`Pay KES ${s==null?void 0:s.amount.toLocaleString()}`})]}),e.jsx("div",{className:"mt-8 text-center",children:e.jsxs("div",{className:"flex items-center justify-center text-sm text-gray-500",children:[e.jsx("svg",{className:"h-4 w-4 mr-1",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M5 9V7a5 5 0 0110 0v2a2 2 0 012 2v5a2 2 0 01-2 2H5a2 2 0 01-2-2v-5a2 2 0 012-2zm8-2v2H7V7a3 3 0 016 0z",clipRule:"evenodd"})}),"Your payment information is secure and encrypted"]})})]})})};export{A as default};
//# sourceMappingURL=Payment-Dm0qsGZf.js.map
